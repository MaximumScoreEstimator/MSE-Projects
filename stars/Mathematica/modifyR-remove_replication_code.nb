(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    155250,       3514]
NotebookOptionsPosition[    149061,       3402]
NotebookOutlinePosition[    149528,       3420]
CellTagsIndexPosition[    149485,       3417]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "\n",
 StyleBox["Companion code for the paper \[OpenCurlyDoubleQuote]Stars In Their \
Constellations: Great person or great team?\[CloseCurlyDoubleQuote] by \
Mindruta, Bercovitz, Mares, and Feldman.",
  FontFamily->"Consolas",
  FontWeight->"Normal",
  FontColor->GrayLevel[0]],
 "\n \n",
 StyleBox["The code calculates the contribution interval (min and max) of an \
agent in a matching game.The code generates the point estimates of the \
matching production function and then uses this solution to calculate the \
contribution interval. See the companion notebook \
(mse_replication_point_estimates_and_CI.nb) for the point estimates and \
confidence intervals. \n\nThe input data for the \
\[OpenCurlyDoubleQuote]Contribution\[CloseCurlyDoubleQuote] step is described \
in the paper (see Section 4.2). Users can apply the code to their input data, \
but need to follow the same data file format. The formula for the min and max \
are described in Section 5 of the paper.  \n\nThe file generated by this code \
has been used in the paper to create Table 3a.Summary statistics and \
additional analyses were done in Stata. The code in Stata is available  upon \
request.\n",
  FontFamily->"Consolas",
  FontSize->14,
  FontWeight->"Normal",
  FontColor->RGBColor[0.5019607843137255, 0., 0.]],
 StyleBox["\n",
  FontFamily->"Consolas",
  FontSize->14,
  FontWeight->"Normal"],
 "\nSet Paths and load Library"
}], "Subsection",
 CellChangeTimes->{{3.715201271217216*^9, 3.715201284491878*^9}, {
   3.715201323018154*^9, 3.7152013455649652`*^9}, {3.901935206373762*^9, 
   3.9019352142331047`*^9}, {3.901935439300352*^9, 3.9019354516653986`*^9}, {
   3.9019363619523573`*^9, 3.9019363927244987`*^9}, {3.901940900018648*^9, 
   3.9019409854009614`*^9}, {3.901941026013381*^9, 3.901941188056577*^9}, {
   3.901941921047058*^9, 3.9019419362318597`*^9}, {3.901952576597927*^9, 
   3.901952578060498*^9}, {3.9019526406414633`*^9, 3.901952815791754*^9}, {
   3.9019591577705393`*^9, 3.901959206606386*^9}, {3.901959270948904*^9, 
   3.901959284527916*^9}, {3.903860061617751*^9, 3.9038601196783752`*^9}, {
   3.9038602105691977`*^9, 3.9038602504351077`*^9}, {3.9038603025803733`*^9, 
   3.9038603029509397`*^9}, {3.9038609996544046`*^9, 3.903861017665901*^9}, 
   3.9042166750477395`*^9, {3.9042167232101345`*^9, 3.9042167276052837`*^9}, {
   3.90421679589126*^9, 3.9042168051853137`*^9}, {3.904363686727188*^9, 
   3.904363698105883*^9}, {3.9049013895713067`*^9, 3.9049013943104715`*^9}, {
   3.904901428578311*^9, 
   3.904901448330427*^9}},ExpressionUUID->"7fe09b6c-a211-4c69-884e-\
8194c3f7cb0c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"directory", "=", 
  "\"\<https://raw.githubusercontent.com/MaximumScoreEstimator/MSE-\
Mathematica/stars/\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   RowBox[{"Get", "[", 
    RowBox[{"directory", "<>", "\"\<mse.m\>\""}], "]"}],
   FontFamily->"Consolas",
   FontSize->14,
   FontWeight->"Normal"], 
  RowBox[{
   StyleBox[
    StyleBox[
     RowBox[{
      StyleBox["(",
       FontFamily->"Consolas"], 
      StyleBox["*",
       FontFamily->"Lucida Sans Unicode"]}]],
    FontSize->14,
    FontWeight->"Normal",
    FontColor->RGBColor[0.5019607843137255, 0., 0.]], 
   StyleBox[" ",
    FontFamily->"Lucida Sans Unicode"], 
   StyleBox[
    RowBox[{
     RowBox[{
      StyleBox["alternatively",
       FontWeight->"Normal"], 
      StyleBox[",",
       FontWeight->"Normal"], 
      StyleBox[" ",
       FontWeight->"Normal"], 
      StyleBox[
       RowBox[{
        RowBox[{
        "users", " ", "can", " ", "download", " ", "the", " ", "code"}], "-", 
        " ", 
        RowBox[{
        "both", " ", "the", " ", "library", " ", "and", " ", "this", " ", 
         "notebook"}], "-", " ", 
        RowBox[{"in", " ", "a", " ", "local", " ", "directory"}]}],
       FontWeight->"Normal"], 
      StyleBox[",",
       FontWeight->"Normal"], 
      StyleBox[" ",
       FontWeight->"Normal"], 
      StyleBox[
       RowBox[{
        RowBox[{
        "and", " ", "read", " ", "the", " ", "input", " ", "file", " ", 
         "from", " ", "the", " ", "local", " ", "directory", " ", "using", 
         " ", "the", " ", "command", " ", "directory"}], "=", 
        StyleBox["\"\<directory path\>\"",
         Background->RGBColor[1., 1., 1.]]}],
       FontWeight->"Normal"], 
      StyleBox[",",
       FontWeight->"Normal",
       Background->RGBColor[1., 1., 1.]], 
      StyleBox[" ",
       FontWeight->"Normal",
       Background->RGBColor[1., 1., 1.]], 
      StyleBox[
       RowBox[{"such", " ", "as"}],
       FontWeight->"Normal",
       Background->RGBColor[1., 1., 1.]], 
      StyleBox[",",
       FontWeight->"Normal",
       Background->RGBColor[1., 1., 1.]], 
      StyleBox[" ",
       FontWeight->"Normal",
       Background->RGBColor[1., 1., 1.]], 
      RowBox[{
       StyleBox[
        RowBox[{
         RowBox[{
          StyleBox["in",
           Background->RGBColor[1., 1., 1.]], 
          StyleBox[" ",
           Background->RGBColor[1., 1., 1.]], 
          RowBox[{
           StyleBox["Windows",
            Background->RGBColor[1., 1., 1.]], 
           StyleBox[":",
            Background->RGBColor[1., 1., 1.]], 
           StyleBox["  ",
            Background->RGBColor[1., 1., 1.]], 
           StyleBox["\[IndentingNewLine]",
            Background->RGBColor[0.94, 0.88, 0.94]], "directory"}]}], "=", 
         "\"\<\!\(\*StyleBox[\"C\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\":\",Background->RGBColor[1., 1., 1.]]\)\!\(\*StyleBox[\
\"\\\\\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"\\\\\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"Users\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"\\\\\\\\\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"mindruta\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"\\\\\\\\\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"Documents\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"\\\\\\\\\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"RESEARCH\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"\\\\\\\\\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"Mathematica\",Background->RGBColor[1., 1., \
1.]]\)\!\(\*StyleBox[\"\\\\\\\\\",Background->RGBColor[1., 1., 1.]]\)\>\""}],
        FontWeight->"Normal"], 
       StyleBox[";",
        FontWeight->"Bold"]}]}], 
     StyleBox["\[IndentingNewLine]",
      FontWeight->"Bold",
      Background->RGBColor[0.94, 0.88, 0.94]], 
     StyleBox[
      RowBox[{
       RowBox[{"Get", "[", 
        RowBox[{"\"\<mse.m\>\"", ",", 
         RowBox[{"Path", "\[Rule]", "directory"}]}], "]"}], ";"}],
      FontWeight->"Bold",
      Background->RGBColor[1., 1., 1.]]}],
    FontFamily->"Consolas",
    FontSize->14,
    FontColor->RGBColor[0.5019607843137255, 0., 0.]], 
   StyleBox["*)",
    FontWeight->"Normal"]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.897711241844165*^9, {3.897714258687591*^9, 3.8977142721957703`*^9}, {
   3.8977150755664873`*^9, 3.897715076611128*^9}, {3.897715994187922*^9, 
   3.8977159960705757`*^9}, {3.901929416656598*^9, 3.901929434180326*^9}, 
   3.901929466729621*^9, {3.901952841458485*^9, 3.9019528425214252`*^9}, {
   3.9019594062539043`*^9, 3.9019595600015583`*^9}, {3.9038643080339575`*^9, 
   3.9038643472895365`*^9}, {3.903864415716606*^9, 3.90386443676153*^9}, {
   3.903867000952764*^9, 3.9038670172450457`*^9}, {3.9039242311533737`*^9, 
   3.903924232578308*^9}, 3.904228973092123*^9, {3.904230037471901*^9, 
   3.9042300380984163`*^9}, {3.9042300688411074`*^9, 
   3.9042300767513995`*^9}, {3.904230206199606*^9, 3.9042302806860976`*^9}, {
   3.9042303378182497`*^9, 3.9042303412497635`*^9}, {3.9042305478778644`*^9, 
   3.9042305533457704`*^9}, 3.904230769275017*^9, 3.9043637808834624`*^9, {
   3.904364348395165*^9, 3.9043643876631927`*^9}, {3.9061756886985273`*^9, 
   3.9061756900292664`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8f1533be-93fc-4a00-b7d4-bfe8c3bb8ac8"],

Cell[BoxData["\<\"https://raw.githubusercontent.com/MaximumScoreEstimator/MSE-\
Mathematica/stars/\"\>"], "Output",
 CellChangeTimes->{3.906178005897151*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"2c6e66ff-8547-4626-9774-2a98e0f3a30a"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Loaded import.m\"\>"], "Echo",
 CellChangeTimes->{
  3.906178006802993*^9},ExpressionUUID->"53383eab-0456-47b4-be3d-\
4e5ac6f6b631"],

Cell[BoxData["\<\"Loaded payoff.m\"\>"], "Echo",
 CellChangeTimes->{
  3.906178007670101*^9},ExpressionUUID->"3194f732-a095-49e5-8b91-\
87a2233b8838"],

Cell[BoxData["\<\"Loaded matching.m\"\>"], "Echo",
 CellChangeTimes->{
  3.906178008825721*^9},ExpressionUUID->"49e0d0c8-496b-436d-bae8-\
c8be717d87af"],

Cell[BoxData["\<\"Loaded inequalities.m\"\>"], "Echo",
 CellChangeTimes->{
  3.9061780095172887`*^9},ExpressionUUID->"92b09a43-08df-4366-a151-\
dce47c4871dc"],

Cell[BoxData["\<\"Loaded dataArray.m\"\>"], "Echo",
 CellChangeTimes->{
  3.9061780100731096`*^9},ExpressionUUID->"a071c550-ef6d-4289-acdb-\
bb5d416484ca"],

Cell[BoxData["\<\"Loaded objective.m\"\>"], "Echo",
 CellChangeTimes->{
  3.906178010581918*^9},ExpressionUUID->"36bfc265-2a30-401a-9980-\
1a1a144d6064"],

Cell[BoxData["\<\"Loaded maximize.m\"\>"], "Echo",
 CellChangeTimes->{
  3.9061780116822157`*^9},ExpressionUUID->"02b7018d-84e0-4cf9-8986-\
17fdfc66c0cc"],

Cell[BoxData["\<\"Loaded confidence.m\"\>"], "Echo",
 CellChangeTimes->{
  3.9061780122347393`*^9},ExpressionUUID->"27fe842e-5f0b-41b3-8015-\
31fe23215618"],

Cell[BoxData["\<\"Loaded modifydata.m\"\>"], "Echo",
 CellChangeTimes->{
  3.9061780139326377`*^9},ExpressionUUID->"4526d3d1-dbcb-4090-b6e5-\
fdff211362b0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"118719120", ",", "102311440", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.906178014838217*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"35073275-887c-49dc-b3fa-262f08b97e43"],

Cell[BoxData["\<\"C:\\\\Users\\\\mindruta\\\\Documents\\\\RESEARCH\\\\msework\
\\\\papers\\\\StarsMSPaperReplication\\\\MSE-Projects-main\\\\stars\\\\\
Mathematica\"\>"], "Output",
 CellChangeTimes->{3.906178014877115*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"57c1a839-7d00-42d3-a166-51b3c0c90f62"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Import Data (Step 1)",
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Subsection",
 CellChangeTimes->{{3.8700563476596527`*^9, 
  3.8700563624529343`*^9}},ExpressionUUID->"3756f8f2-542d-4771-85df-\
17bc9b26014d"],

Cell[TextData[StyleBox["The code reads an input file in a specific format, as \
follows : marketid (integers only, from 1 to max number of markets), \
upstreamid (integers only, from 1 to max number of upstream agents in the \
corresponding market) downstreamid (integers only, from 1 to max number of \
downstream agents, in the corresponding market), matching indicator (1 if the \
corresponding upstream and downstream agents are matched, 0 otherwise), \
matching_attribute_1, ..., matching_attribute_n, and two additional columns \
(removeup and removedown) that identify the agents whose contributions we \
want to calculate. Because calculations require removing these agents \
(upstream, respectively, downstream) from the market and rematching their \
previous match(es) (downstream, respectively, upstream) with another agent in \
the same market, the code refers to this operation as the \
\[OpenCurlyDoubleQuote]remove\[CloseCurlyDoubleQuote] process. Accordingly, \
the last two columns removeup and removedown are equal to 1 if an upstream or \
a downstream agent should be removed from the market and 0 otherwise. In the \
code, agents are removed by simply setting their quota to zero (see below).\n\
\nThe input file should always be sorted by marketid, upstreamid, \
downstreamid. The code does not support missing data. \n\nThe file \
\[OpenCurlyDoubleQuote]precomputed.dat\[CloseCurlyDoubleQuote] is an \
intermediary file necessary for calculations. It will be generated every time \
the code runs and will be stored locally. Do not delete it until you get the \
final output. ",
 FontFamily->"Consolas",
 FontSize->14,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Text",
 CellChangeTimes->{
  3.870056453482073*^9, {3.871187653571866*^9, 3.871187663692111*^9}, 
   3.898904700370616*^9, {3.898928018979516*^9, 3.898928020015016*^9}, {
   3.901931553828198*^9, 3.901931573265443*^9}, {3.90195288734542*^9, 
   3.9019535819483166`*^9}, {3.9019536301824083`*^9, 
   3.9019536481050005`*^9}, {3.901953696857028*^9, 3.901953738018054*^9}, {
   3.901954323087556*^9, 3.9019545690170803`*^9}, {3.9038603348401623`*^9, 
   3.9038604661968336`*^9}, {3.9038605246791925`*^9, 3.90386056041586*^9}, {
   3.9038607923257732`*^9, 3.9038608308396907`*^9}, {3.9038641204496365`*^9, 
   3.9038641435594244`*^9}, {3.9042292278033156`*^9, 3.904229337188326*^9}, {
   3.9042293695885286`*^9, 3.90422937482332*^9}, {3.90422942565454*^9, 
   3.9042295002541227`*^9}},ExpressionUUID->"f7410fed-727d-4541-9c59-\
8c44a531b5ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"filename", "=", "\"\<../data/stars_replication_step2.dat\>\""}], 
   ";"}], " ", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "the", " ", "original", " ", "file", " ", "used", " ", "in", " ", "the", 
      " ", "paper"}], ";", " ", 
     RowBox[{
     "interested", " ", "users", " ", "can", " ", "upload", " ", "their", " ",
       "own", " ", "file", " ", "here"}]}], "*)"}],
   FontFamily->"Consolas",
   FontSize->14,
   FontWeight->"Normal",
   FontColor->RGBColor[0.6, 0.4, 0.2]]}]], "Input",
 CellChangeTimes->{{3.897715115730977*^9, 3.897715133079192*^9}, {
  3.901953593518853*^9, 3.901953611516368*^9}, {3.901959235030077*^9, 
  3.901959260024328*^9}, {3.9038638759431705`*^9, 3.9038638773669615`*^9}, {
  3.9038669261227016`*^9, 3.903866927703418*^9}, {3.903866974525329*^9, 
  3.90386697575893*^9}, {3.903867051484448*^9, 3.903867054666109*^9}, {
  3.9042298609691734`*^9, 3.9042298620943327`*^9}},
 Background->RGBColor[1, 1, 0],
 CellLabel->"In[4]:=",ExpressionUUID->"50354017-71e3-463e-bfed-fdbe502b1b57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"importCSV", "[", "filename", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"writeYourTSV", "[", 
   RowBox[{"\"\<precomputed.dat\>\"", ",", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"1", ";;", 
        RowBox[{"(", 
         RowBox[{"-", "3"}], ")"}]}]}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "header", ",", "noM", ",", "noU", ",", "noD", ",", "noAttr", ",", 
     "distanceMatrices", ",", "matchMatrix", ",", "mate"}], "}"}], "=", 
   RowBox[{"import", "[", 
    RowBox[{"\"\<precomputed.dat\>\"", ",", "\"\<precomp\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removes", "=", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;", "All"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", 
        RowBox[{"-", "2"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ";", 
  RowBox[{"data", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removeu", "=", 
   RowBox[{"Union", "@", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"removes", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removed", "=", 
   RowBox[{"Union", "@", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"removes", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"removes", "=", 
   RowBox[{"removes", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CpayoffMatrix", "[", 
   RowBox[{"payoffDM", ",", "noM", ",", "noU", ",", "noD"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cineqmembers", "[", "mate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CdataArray", "[", 
   RowBox[{"payoffMatrix", ",", 
    RowBox[{"Cx", "[", 
     RowBox[{"noAttr", "-", "1"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"originalmatchMatrix", "=", "matchMatrix"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8700585348020477`*^9, 3.870058575008821*^9}, 
   3.8700609930193367`*^9, {3.898927906437317*^9, 3.8989279123290653`*^9}, {
   3.898936155349147*^9, 3.898936155832509*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"a3cb0087-1fc8-4701-9eea-294d587904c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{"\"\<Import Output\>\"", ",", "Bold", ",", "Larger"}], "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<File's first line\>\"", ",", "Bold"}], "]"}], ",", 
       "\"\< header = \>\"", ",", "header"}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Number of Markets\>\"", ",", "Bold"}], "]"}], ",", 
       "\"\< noM = \>\"", ",", "noM"}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Number of upstreams per market\>\"", ",", "Bold"}], 
        "]"}], ",", "\"\< noU = \>\"", ",", "noU"}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Number of downstreams per market\>\"", ",", "Bold"}], 
        "]"}], ",", "\"\< noD = \>\"", ",", "noD"}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Number of attributes\>\"", ",", "Bold"}], "]"}], ",", 
       "\"\< noAttr = \>\"", ",", "noAttr"}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"OpenerView", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<removeu list\>\"", ",", "removeu"}], "}"}], ",", "True"}],
      "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OpenerView", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<removed list\>\"", ",", "removed"}], "}"}], ",", "True"}],
      "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.870058425438458*^9, 3.870058496691266*^9}, {
   3.870058667226824*^9, 3.870058726523549*^9}, {3.870058802205758*^9, 
   3.87005880826478*^9}, 3.871020170691084*^9, {3.898927919696575*^9, 
   3.89892792826344*^9}, {3.8989279882071133`*^9, 3.898927997054154*^9}, {
   3.8989361610186367`*^9, 3.898936163509988*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c7ef506b-9ea5-40ec-bd93-32f7a9dfb21e"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Import Output\"\>",
      StripOnInput->False,
      FontSize->Larger,
      FontWeight->Bold]},
    {
     TemplateBox[{
       StyleBox["\"File's first line\"", Bold, StripOnInput -> False], 
       "\" header = \"", 
       RowBox[{"{", 
         RowBox[{
          "\"marketid\"", ",", "\"upstreamid\"", ",", "\"downstreamid\"", ",",
            "\"cites_cites\"", ",", "\"cites_size\"", ",", 
           "\"kn_similarity\"", ",", "\"_sq (kn_similarity)\"", ",", 
           "\"domain_similarity\"", ",", "\"cites_rankcmd\"", ",", 
           "\"cites_experience\"", ",", "\"match\""}], "}"}]},
      "RowDefault"]},
    {
     TemplateBox[{
       StyleBox["\"Number of Markets\"", Bold, StripOnInput -> False], 
       "\" noM = \"", "33"},
      "RowDefault"]},
    {
     TemplateBox[{
       StyleBox[
       "\"Number of upstreams per market\"", Bold, StripOnInput -> False], 
       "\" noU = \"", 
       RowBox[{"{", 
         RowBox[{
          "9", ",", "12", ",", "7", ",", "9", ",", "8", ",", "7", ",", "7", 
           ",", "11", ",", "6", ",", "12", ",", "21", ",", "8", ",", "14", 
           ",", "21", ",", "7", ",", "11", ",", "21", ",", "15", ",", "14", 
           ",", "24", ",", "10", ",", "18", ",", "19", ",", "12", ",", "18", 
           ",", "30", ",", "8", ",", "18", ",", "22", ",", "15", ",", "16", 
           ",", "28", ",", "10"}], "}"}]},
      "RowDefault"]},
    {
     TemplateBox[{
       StyleBox[
       "\"Number of downstreams per market\"", Bold, StripOnInput -> False], 
       "\" noD = \"", 
       RowBox[{"{", 
         RowBox[{
          "9", ",", "13", ",", "7", ",", "12", ",", "10", ",", "7", ",", "8", 
           ",", "12", ",", "7", ",", "15", ",", "25", ",", "8", ",", "17", 
           ",", "26", ",", "7", ",", "16", ",", "23", ",", "16", ",", "17", 
           ",", "29", ",", "10", ",", "21", ",", "21", ",", "14", ",", "32", 
           ",", "37", ",", "8", ",", "23", ",", "24", ",", "16", ",", "23", 
           ",", "30", ",", "12"}], "}"}]},
      "RowDefault"]},
    {
     TemplateBox[{
       StyleBox["\"Number of attributes\"", Bold, StripOnInput -> False], 
       "\" noAttr = \"", "7"},
      "RowDefault"]},
    {
     TagBox[
      DynamicModuleBox[{Typeset`var$$ = True}, 
       InterpretationBox[
        StyleBox[
         PaneSelectorBox[{False->GridBox[{
            {
             OpenerBox[Dynamic[Typeset`var$$],
              Appearance->Automatic,
              AutoAction->False,
              ContinuousAction->False,
              Enabled->Automatic], "\<\"removeu list\"\>"}
           },
           AutoDelete->False,
           BaselinePosition->{1, 1},
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {{Automatic}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
           GridBoxSpacings->{"Columns" -> {{0.2}}, "Rows" -> {{0.5}}}], True->
          GridBox[{
            {
             OpenerBox[Dynamic[Typeset`var$$],
              Appearance->Automatic,
              AutoAction->False,
              ContinuousAction->False,
              Enabled->Automatic], "\<\"removeu list\"\>"},
            {"", 
             PaneBox[
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"8", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"9", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"11", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"11", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"12", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"13", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"13", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"13", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"15", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "13"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"18", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"18", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"19", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"19", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"19", ",", "11"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"21", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"21", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"22", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"22", ",", "14"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"23", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"23", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"24", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"24", ",", "9"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "14"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"27", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"28", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"28", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"28", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "18"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "21"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"30", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "13"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "14"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"32", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"32", ",", "25"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"33", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"33", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"33", ",", "9"}], "}"}]}], "}"}],
              ImageMargins->0]}
           },
           AutoDelete->False,
           BaselinePosition->{1, 1},
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {{Automatic}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
           GridBoxSpacings->{"Columns" -> {{0.2}}, "Rows" -> {{0.5}}}]}, 
          Dynamic[Typeset`var$$],
          Alignment->Automatic,
          BaseStyle->{},
          BaselinePosition->Baseline,
          DefaultBaseStyle->"OpenerView",
          ImageMargins->0,
          ImageSize->Automatic],
         Deployed->False,
         StripOnInput->False],
        OpenerView[{
         "removeu list", {{1, 4}, {2, 6}, {3, 5}, {4, 1}, {4, 2}, {4, 4}, {5, 
          2}, {5, 4}, {6, 6}, {7, 1}, {7, 2}, {7, 4}, {8, 4}, {9, 4}, {10, 
          3}, {10, 6}, {10, 12}, {11, 2}, {11, 8}, {12, 3}, {13, 1}, {13, 
          2}, {13, 5}, {14, 1}, {14, 2}, {14, 12}, {15, 2}, {16, 2}, {16, 
          6}, {17, 1}, {17, 2}, {17, 5}, {17, 13}, {18, 6}, {18, 7}, {19, 
          1}, {19, 3}, {19, 11}, {20, 1}, {20, 3}, {20, 16}, {21, 2}, {21, 
          6}, {22, 3}, {22, 14}, {23, 3}, {23, 7}, {24, 1}, {24, 9}, {25, 
          2}, {25, 7}, {25, 14}, {26, 1}, {26, 5}, {26, 12}, {27, 8}, {28, 
          2}, {28, 6}, {28, 8}, {29, 2}, {29, 5}, {29, 18}, {29, 21}, {30, 
          6}, {31, 6}, {31, 12}, {31, 13}, {31, 14}, {32, 16}, {32, 25}, {33, 
          6}, {33, 7}, {33, 9}}}, True]],
       DynamicModuleValues:>{}],
      Setting[#, {0}]& ]},
    {
     TagBox[
      DynamicModuleBox[{Typeset`var$$ = True}, 
       InterpretationBox[
        StyleBox[
         PaneSelectorBox[{False->GridBox[{
            {
             OpenerBox[Dynamic[Typeset`var$$],
              Appearance->Automatic,
              AutoAction->False,
              ContinuousAction->False,
              Enabled->Automatic], "\<\"removed list\"\>"}
           },
           AutoDelete->False,
           BaselinePosition->{1, 1},
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {{Automatic}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
           GridBoxSpacings->{"Columns" -> {{0.2}}, "Rows" -> {{0.5}}}], True->
          GridBox[{
            {
             OpenerBox[Dynamic[Typeset`var$$],
              Appearance->Automatic,
              AutoAction->False,
              ContinuousAction->False,
              Enabled->Automatic], "\<\"removed list\"\>"},
            {"", 
             PaneBox[
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "9"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "13"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "9"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"8", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"9", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "13"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"10", ",", "15"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"11", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"11", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"11", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"11", ",", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"11", ",", "17"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"12", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"13", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"13", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"13", ",", "13"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "11"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "15"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"14", ",", "17"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"15", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "14"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"16", ",", "15"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "10"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"17", ",", "14"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"18", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"18", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"19", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"19", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"19", ",", "11"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"19", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "9"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "11"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"20", ",", "14"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"21", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"21", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"22", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"22", ",", "21"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"23", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"23", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"24", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"24", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "9"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "15"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "17"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "19"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "20"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "21"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "24"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "26"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"25", ",", "27"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "11"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "29"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "36"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"26", ",", "37"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"27", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"28", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"28", ",", "11"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"28", ",", "21"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "18"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "23"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"29", ",", "24"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"30", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "12"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "16"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "18"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"31", ",", "22"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"32", ",", "8"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"32", ",", "21"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"32", ",", "27"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"33", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"33", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"33", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"33", ",", "12"}], "}"}]}], "}"}],
              ImageMargins->0]}
           },
           AutoDelete->False,
           BaselinePosition->{1, 1},
           GridBoxAlignment->{"Columns" -> {{Left}}},
           GridBoxBackground->{"Columns" -> {{Automatic}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
           GridBoxSpacings->{"Columns" -> {{0.2}}, "Rows" -> {{0.5}}}]}, 
          Dynamic[Typeset`var$$],
          Alignment->Automatic,
          BaseStyle->{},
          BaselinePosition->Baseline,
          DefaultBaseStyle->"OpenerView",
          ImageMargins->0,
          ImageSize->Automatic],
         Deployed->False,
         StripOnInput->False],
        OpenerView[{
         "removed list", {{1, 9}, {2, 6}, {2, 13}, {3, 5}, {4, 1}, {4, 3}, {4,
           5}, {4, 6}, {4, 9}, {4, 12}, {5, 7}, {5, 8}, {6, 1}, {7, 3}, {7, 
          5}, {7, 8}, {8, 1}, {9, 2}, {10, 1}, {10, 7}, {10, 8}, {10, 13}, {
          10, 15}, {11, 5}, {11, 7}, {11, 8}, {11, 10}, {11, 17}, {12, 8}, {
          13, 2}, {13, 7}, {13, 13}, {14, 3}, {14, 10}, {14, 11}, {14, 15}, {
          14, 16}, {14, 17}, {15, 2}, {16, 3}, {16, 4}, {16, 14}, {16, 15}, {
          17, 1}, {17, 2}, {17, 10}, {17, 12}, {17, 14}, {18, 2}, {18, 16}, {
          19, 2}, {19, 7}, {19, 11}, {19, 12}, {20, 2}, {20, 9}, {20, 11}, {
          20, 14}, {21, 5}, {21, 6}, {22, 16}, {22, 21}, {23, 6}, {23, 16}, {
          24, 2}, {24, 4}, {25, 4}, {25, 9}, {25, 15}, {25, 17}, {25, 19}, {
          25, 20}, {25, 21}, {25, 24}, {25, 26}, {25, 27}, {26, 2}, {26, 
          11}, {26, 29}, {26, 36}, {26, 37}, {27, 5}, {28, 8}, {28, 11}, {28, 
          21}, {29, 3}, {29, 18}, {29, 23}, {29, 24}, {30, 4}, {31, 1}, {31, 
          2}, {31, 4}, {31, 8}, {31, 12}, {31, 16}, {31, 18}, {31, 22}, {32, 
          8}, {32, 21}, {32, 27}, {33, 2}, {33, 5}, {33, 7}, {33, 12}}}, 
         True]],
       DynamicModuleValues:>{}],
      Setting[#, {0}]& ]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.9061780199281483`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"d7d79d03-1fcb-45ec-8e25-c0bf625cc02f"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"exportmatch", "=", "33"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Specifies", " ", "the", " ", "market", " ", "index", " ", "that", " ", 
      "we", " ", "want", " ", "to", " ", "export", " ", "after", " ", 
      "rematching"}], ",", " ", 
     RowBox[{
     "in", " ", "order", " ", "to", " ", "understand", " ", "how", " ", "the",
       " ", "agents", " ", "rematch", " ", "after", " ", "we", " ", "applied",
       " ", "the", " ", "\"\<remove\>\"", " ", 
      RowBox[{"operations", "."}]}]}], "*)"}]}],
  Background->RGBColor[1, 1, 0]]], "Input",
 CellChangeTimes->{{3.8700588191885967`*^9, 3.870058866400601*^9}, {
   3.870061996060381*^9, 3.870062016304096*^9}, {3.87102673612829*^9, 
   3.871026766192196*^9}, {3.8710391539937897`*^9, 3.8710391590189266`*^9}, {
   3.8711878508988724`*^9, 3.871187950095854*^9}, 3.877596639054172*^9, {
   3.877596675033846*^9, 3.8775966896873465`*^9}, {3.878902120426602*^9, 
   3.878902129266822*^9}, {3.878902531106553*^9, 3.8789025354203205`*^9}, 
   3.8789771506191688`*^9, {3.878977259894775*^9, 3.878977260793341*^9}, {
   3.87898539214209*^9, 3.878985398880678*^9}, {3.8789857483008595`*^9, 
   3.8789857721357265`*^9}, {3.8791377539464307`*^9, 
   3.8791377718369417`*^9}, {3.879150980079056*^9, 3.879150991511305*^9}, {
   3.879266301606099*^9, 3.8792663057143564`*^9}, {3.8792663463285255`*^9, 
   3.8792663473673143`*^9}, 3.8792665071425543`*^9, {3.8793564393090553`*^9, 
   3.879356439912798*^9}, {3.8793581801833057`*^9, 3.879358181529087*^9}, {
   3.8793593400925665`*^9, 3.8793593425475264`*^9}, {3.8793599090570827`*^9, 
   3.8793599092805233`*^9}, {3.8794141242902927`*^9, 
   3.8794141270903544`*^9}, {3.879414159505192*^9, 3.8794141604272337`*^9}, {
   3.879414544406881*^9, 3.879414544570562*^9}, {3.8794220800111136`*^9, 
   3.879422081979911*^9}, {3.8794247448966913`*^9, 3.8794247459235334`*^9}, {
   3.8794250593701696`*^9, 3.879425059533627*^9}, {3.879441232330285*^9, 
   3.879441236210541*^9}, {3.879446196769206*^9, 3.8794462221741624`*^9}, {
   3.879481555997995*^9, 3.8794815572042494`*^9}, {3.8794819298333917`*^9, 
   3.87948193308352*^9}, {3.87948221284725*^9, 3.879482216505742*^9}, {
   3.879482435932906*^9, 3.8794824415567245`*^9}, {3.879482698763198*^9, 
   3.8794826995175924`*^9}, {3.879486843562749*^9, 3.879486853724389*^9}, {
   3.879489496273529*^9, 3.8794894974631324`*^9}, {3.8794974831164756`*^9, 
   3.8794974838613596`*^9}, 3.879497670161979*^9, {3.87950348963774*^9, 
   3.879503517735093*^9}, {3.879506605370775*^9, 3.879506609450053*^9}, {
   3.8795068756652317`*^9, 3.879506882084746*^9}, {3.8795070316787233`*^9, 
   3.8795070324146056`*^9}, {3.879511086882201*^9, 3.879511087045232*^9}, {
   3.8795132227966957`*^9, 3.879513232597404*^9}, {3.879514914068721*^9, 
   3.879514916018335*^9}, {3.8795205212399435`*^9, 3.879520521347975*^9}, 
   3.8795233686768546`*^9, {3.8795252379892025`*^9, 3.8795252383893747`*^9}, {
   3.8795259253551555`*^9, 3.879525935787758*^9}, {3.8795896861378007`*^9, 
   3.879589694785968*^9}, 3.8795909375557613`*^9, {3.879591611237273*^9, 
   3.879591611385479*^9}, {3.8795958480024247`*^9, 3.8795958574080853`*^9}, 
   3.879599139625188*^9, {3.8796231559117765`*^9, 3.8796231567283173`*^9}, 
   3.8796634722048807`*^9, {3.8796717573441963`*^9, 3.879671767920035*^9}, {
   3.879672384762789*^9, 3.8796723861231637`*^9}, {3.879672428070981*^9, 
   3.8796724296723366`*^9}, {3.879672506474902*^9, 3.8796725093350086`*^9}, {
   3.879672647467103*^9, 3.879672648763427*^9}, {3.8796726858945217`*^9, 
   3.8796726872488246`*^9}, {3.879672727358281*^9, 3.8796728479826207`*^9}, {
   3.879672984935162*^9, 3.879672986089897*^9}, {3.879673030091276*^9, 
   3.8796730334211807`*^9}, {3.8796730743542414`*^9, 
   3.8796730775610046`*^9}, {3.8796731230392504`*^9, 3.879673150864555*^9}, {
   3.8796732179328365`*^9, 3.879673221002039*^9}, {3.8796732718406954`*^9, 
   3.879673275216075*^9}, {3.879673317032218*^9, 3.8796734598732796`*^9}, {
   3.879673492481552*^9, 3.8796736706159525`*^9}, {3.897718698757099*^9, 
   3.897718699434667*^9}, 3.8989280554169273`*^9, {3.9019537587811117`*^9, 
   3.901953964821886*^9}, {3.9038608845614214`*^9, 3.9038608853115835`*^9}, {
   3.9038678184403133`*^9, 3.903867819150322*^9}, {3.903867913241226*^9, 
   3.903867913958085*^9}},
 Background->RGBColor[1, 1, 0],
 CellLabel->"In[17]:=",ExpressionUUID->"6de7a44a-fc10-4e79-94b2-5291b58d8828"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["1. Step 1: Finds solution of the matching equation",
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Subsubsection",
 CellChangeTimes->{{3.870058988796791*^9, 3.870058992056904*^9}, {
  3.87005906529541*^9, 3.870059065978108*^9}, {3.901954013136063*^9, 
  3.9019540340772743`*^9}, {3.903861300272114*^9, 3.903861318167865*^9}, {
  3.9038619606061554`*^9, 3.903861963262765*^9}, {3.9038623204498034`*^9, 
  3.903862320864658*^9}},ExpressionUUID->"6bb2c1a3-ef81-46c2-a3a8-\
ff31ae323afc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"method", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<DifferentialEvolution\>\"", ",", 
     RowBox[{"\"\<CrossProbability\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<InitialPoints\>\"", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"\"\<PenaltyFunction\>\"", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"\"\<PostProcess\>\"", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"\"\<RandomSeed\>\"", "\[Rule]", "321"}], ",", 
     RowBox[{"\"\<ScalingFactor\>\"", "\[Rule]", "0.6"}], ",", 
     RowBox[{"\"\<SearchPoints\>\"", "\[Rule]", "300"}], ",", 
     RowBox[{"\"\<Tolerance\>\"", "\[Rule]", "0.001"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"maximize", "[", 
    RowBox[{"dataArray", ",", "noAttr", ",", "method"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CpayoffMatrix", "[", 
   RowBox[{"sol", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ctotalpayoff", "[", 
   RowBox[{"payoffMatrix", ",", 
    RowBox[{"Cmates", "[", "matchMatrix", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", "sol"}], "Input",
 CellChangeTimes->{{3.870058996266652*^9, 3.87005901810465*^9}, {
  3.8775967184514294`*^9, 3.8775967190737257`*^9}, {3.9038678125156727`*^9, 
  3.903867835711358*^9}, {3.9061758927458954`*^9, 3.9061758945180874`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"ebee67b7-4cc4-46aa-b3b8-0dcdfa5bfd49"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\" The new ordering of attributes used for calculating the \
solutio order=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6", ",", "1", ",", "3", ",", "2", ",", "4"}], "}"}]}],
  SequenceForm[
  " The new ordering of attributes used for calculating the solutio order=", {
   5, 6, 1, 3, 2, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9061780553357515`*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"1035315b-8dae-43fc-bee6-4b78f30d9acc"],

Cell[BoxData["\<\"Method {DifferentialEvolution, CrossProbability -> 0.5, \
InitialPoints -> Automatic, PenaltyFunction -> Automatic, PostProcess -> \
Automatic, RandomSeed -> 321, ScalingFactor -> 0.6, SearchPoints -> 300, \
Tolerance -> 0.001}\"\>"], "Print",
 CellChangeTimes->{3.9061780553487153`*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"c034edc6-6e3c-4c3b-b4ae-8ddd5b7063a9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Completed : \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Number of satisfied inequalities\"\>", "\[Rule]", 
      "3733.`"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"cites_size\"\>", "\[Rule]", "0.8647185894805215`"}], ",", 
       RowBox[{"\<\"kn_similarity\"\>", "\[Rule]", "5.779401410940838`"}], 
       ",", 
       RowBox[{"\<\"_sq (kn_similarity)\"\>", "\[Rule]", 
        RowBox[{"-", "2.6456032704736994`"}]}], ",", 
       RowBox[{"\<\"domain_similarity\"\>", "\[Rule]", 
        "3.3901711331785256`"}], ",", 
       RowBox[{"\<\"cites_rankcmd\"\>", "\[Rule]", "1.6199736480992488`"}], 
       ",", 
       RowBox[{"\<\"cites_experience\"\>", "\[Rule]", 
        "2.0775031924093352`"}]}], "}"}], ",", 
     RowBox[{"\<\"Number of inequalities\"\>", "\[Rule]", "3745"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\"\\nSatisfied Ineqs Analysis:\\n \"\>", 
   "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {"\<\"Market no\"\>", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10",
        "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", 
       "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33"},
      {"\<\"Satisfied\"\>", "36", "66", "21", "36", "28", "21", "21", "55", 
       "15", "66", "208", "28", "90", "209", "21", "55", "209", "104", "91", 
       "276", "44", "150", "170", "66", "153", "435", "28", "153", "231", 
       "105", "120", "377", "45"},
      {"\<\"Total\"\>", "36", "66", "21", "36", "28", "21", "21", "55", "15", 
       "66", "210", "28", "91", "210", "21", "55", "210", "105", "91", "276", 
       "45", "153", "171", "66", "153", "435", "28", "153", "231", "105", 
       "120", "378", "45"},
      {"\<\"Percentage %\"\>", "100", "100", "100", "100", "100", "100", 
       "100", "100", "100", "100", "99", "100", "99", "100", "100", "100", 
       "100", "99", "100", "100", "98", "98", "99", "100", "100", "100", 
       "100", "100", "100", "100", "100", "100", "100"}
     },
     AutoDelete->False,
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
  "Completed : ", {
   "Number of satisfied inequalities" -> 3733., {
    "cites_size" -> 0.8647185894805215, "kn_similarity" -> 5.779401410940838, 
     "_sq (kn_similarity)" -> -2.6456032704736994`, "domain_similarity" -> 
     3.3901711331785256`, "cites_rankcmd" -> 1.6199736480992488`, 
     "cites_experience" -> 2.0775031924093352`}, "Number of inequalities" -> 
    3745}, "\nSatisfied Ineqs Analysis:\n ", 
   Grid[{{
     "Market no", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
      18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33}, {
     "Satisfied", 36, 66, 21, 36, 28, 21, 21, 55, 15, 66, 208, 28, 90, 209, 
      21, 55, 209, 104, 91, 276, 44, 150, 170, 66, 153, 435, 28, 153, 231, 
      105, 120, 377, 45}, {
     "Total", 36, 66, 21, 36, 28, 21, 21, 55, 15, 66, 210, 28, 91, 210, 21, 
      55, 210, 105, 91, 276, 45, 153, 171, 66, 153, 435, 28, 153, 231, 105, 
      120, 378, 45}, {
     "Percentage %", 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 99, 
      100, 99, 100, 100, 100, 100, 99, 100, 100, 98, 98, 99, 100, 100, 100, 
      100, 100, 100, 100, 100, 100, 100}}, Frame -> All]],
  Editable->False]], "Print",
 CellChangeTimes->{3.906178055370658*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"af512817-c092-47fe-948a-4c61973b4280"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3733.`", ",", 
   RowBox[{"{", 
    RowBox[{"0.8647185894805215`", ",", "5.779401410940838`", ",", 
     RowBox[{"-", "2.6456032704736994`"}], ",", "3.3901711331785256`", ",", 
     "1.6199736480992488`", ",", "2.0775031924093352`"}], "}"}], ",", 
   "3745"}], "}"}]], "Output",
 CellChangeTimes->{3.9061780555062933`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"85c5b6e7-3c5f-4443-ab92-86a5c972e9a2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["2. Intermediary step: Sets the matching payoffMatrix \
to positive",
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Subsection",
 CellChangeTimes->{
  3.870061102168541*^9, {3.901954065041587*^9, 3.901954065982995*^9}, {
   3.9019541747721505`*^9, 3.901954181977618*^9}, {3.901955401813882*^9, 
   3.9019554094310246`*^9}, 3.903861283007449*^9, {3.9038623405914373`*^9, 
   3.903862340810023*^9}, {3.9038624358804283`*^9, 
   3.9038624360522575`*^9}},ExpressionUUID->"8563995e-cdb6-4666-b308-\
3fae7db4cd29"],

Cell[TextData[StyleBox["This step executes an affine transformation on the \
payoff matrix (the matrix that contains the payoffs of all real and \
counterfactual matches). The transformation does not affect the formula for \
the min and max calculations. It leads to fewer and simpler inequalities, so \
the DE method converges faster. For each Market the minimum payoff is found. \
The vector of all minimums across all markets is called \
\[OpenCurlyDoubleQuote]offset\[CloseCurlyDoubleQuote]. The payoffMatrix is \
shifted along the offset so the minimum payoff in each market becomes 0.",
 FontFamily->"Consolas",
 FontSize->14,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Text",
 CellChangeTimes->{{3.8989048152813396`*^9, 3.898905259892215*^9}, {
  3.901954079240348*^9, 3.901954144298539*^9}, {3.901954189053046*^9, 
  3.9019542399884377`*^9}, {3.9019542869865723`*^9, 3.90195428731686*^9}, {
  3.9038619422877283`*^9, 3.903861942927023*^9}, {3.904217049821595*^9, 
  3.904217051711524*^9}, {3.904217088422033*^9, 3.904217114470354*^9}, {
  3.9042171498019924`*^9, 
  3.9042171629119773`*^9}},ExpressionUUID->"d1344fae-e741-4eba-9bb7-\
f2b769084ccb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"payoffMatrix", "=", 
    RowBox[{"payoffMatrix2Positive", "[", 
     RowBox[{"offset", ",", "payoffMatrix"}], "]"}]}], ";", "offset"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.870061106702627*^9, 3.870061119717842*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"8571a603-b3c4-43a7-bbba-57143cd79415"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0.04236147318392515`", ",", "0", 
   ",", "0.6953690367718477`", ",", "0.0017395100638049076`", ",", "0", ",", 
   "0.002108962663347643`", ",", "0", ",", "0", ",", "0.027639947431167364`", 
   ",", "9.909373356270662`*^-18", ",", "0", ",", "0.7311649388435348`", ",", 
   "0.007288193135713061`", ",", "0", ",", "0.24581263297540235`", ",", 
   "1.1873390703826151`*^-18", ",", "0", ",", "0", ",", 
   "0.0010296546808757053`", ",", "0", ",", "0.368802172082965`", ",", "0", 
   ",", "0", ",", "0.2254737896363546`", ",", "0", ",", "0", ",", 
   "0.8703818722274308`", ",", "7.483610569558438`*^-18", ",", 
   "7.001555816841638`*^-17"}], "}"}]], "Output",
 CellChangeTimes->{3.906178055667862*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"4e5614c6-244e-4e48-a90c-19eae1276feb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["3. Intermediary step: Stores quota,totalpayoff etc...",
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Subsection",
 CellChangeTimes->{
  3.870061142273271*^9, {3.9019554146844306`*^9, 3.9019554191296835`*^9}, 
   3.9038612782184877`*^9},ExpressionUUID->"0c7d507c-902a-4993-b7ee-\
a14361e88265"],

Cell[TextData[StyleBox["In the original data, each upstream and downstream in \
each market is matched with a specific number of downstreams and upstreams, \
respectively. This number is called \[OpenCurlyDoubleQuote]quota\
\[CloseCurlyDoubleQuote]. The store function below saves the quota of agents \
in the original data. This information is later used to restore the quota in \
the rematching process that follows the removal of an upstream or downstream. \
Thus, all agents who are not \[OpenCurlyDoubleQuote]removed\
\[CloseCurlyDoubleQuote] from the market maintain their original quota when a \
new matching configuration must be calculated.",
 FontFamily->"Consolas",
 FontSize->14,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Text",
 CellChangeTimes->{{3.898905269958207*^9, 3.898905434008412*^9}, {
   3.89893624730418*^9, 3.898936261390874*^9}, {3.9019546429839315`*^9, 
   3.901954729474461*^9}, 3.90195478265902*^9, {3.90195484068819*^9, 
   3.9019548516312447`*^9}, {3.901954882744773*^9, 3.9019548832623444`*^9}, {
   3.90386113712031*^9, 3.9038611790177536`*^9}, {3.9038612138777347`*^9, 
   3.9038612264208655`*^9}, {3.904228231571493*^9, 3.904228233560406*^9}, {
   3.9042282688209653`*^9, 3.9042283143141923`*^9}, {3.9042283678215895`*^9, 
   3.9042284146495733`*^9}, {3.9043639105800915`*^9, 
   3.90436394513268*^9}},ExpressionUUID->"a33d4ea2-79f7-4d8a-8af9-\
fce5024a3243"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cquota", "[", "matchMatrix", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ctotalpayoff", "[", 
   RowBox[{"payoffMatrix", ",", 
    RowBox[{"Cmates", "[", "matchMatrix", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"store", "[", 
   RowBox[{"stored", ",", "True"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.870061148573853*^9, 3.870061167959916*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"b3f66ee3-1351-4107-8b1c-6ef557879141"],

Cell[CellGroupData[{

Cell[BoxData["\<\"quota is calculated for the first time. \
Initializing...\"\>"], "Print",
 CellChangeTimes->{3.9061780557227163`*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"28a99a96-d6ca-454e-9f98-391430eea07f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Stored \"\>", "\[InvisibleSpace]", "2898336", 
   "\[InvisibleSpace]", "\<\" bytes to \\\"stored\\\" Association List: \\n \
header, noM, noU, noD, noAttr, distanceMatrices, matchMatrix, mate, quota, \
payoffMatrix, dataArray\"\>"}],
  SequenceForm[
  "Stored ", 2898336, 
   " bytes to \"stored\" Association List: \n header, noM, noU, noD, noAttr, \
distanceMatrices, matchMatrix, mate, quota, payoffMatrix, dataArray"],
  Editable->False]], "Print",
 CellChangeTimes->{3.90617805573269*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"79132a56-d695-42f6-9f49-1756272d6eb3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["quota"], "Input",
 CellChangeTimes->{{3.898934484633274*^9, 3.8989344859009523`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"5173f81e-5259-40de-b185-6334f7d0838b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"upstream\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "1", ",", "1", ",", "3", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "3", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
        "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "3", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
        "1", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
        "1", ",", "4", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "3", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
        "2", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "2", ",", "4", ",", 
        "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "4", ",", 
        "1", ",", "3", ",", "2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "3", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "2", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
        "1", ",", "5", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "2", ",", "1", ",", "2", ",", "3", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "3", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "1", ",", "2"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", 
        "1", ",", "1", ",", "2"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"downstream\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.906178055801506*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"65b3d68e-10a3-4561-9cfb-66a760a0134b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["4. Intermediary step: Specifies the process for \
removing agents from the market and rematching those remaining ones via \
modifyR function",
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Subsection",
 CellChangeTimes->{{3.898037057573924*^9, 3.8980370652763863`*^9}, {
  3.9019554267750835`*^9, 3.901955507034769*^9}, {3.903861288097325*^9, 
  3.903861289460557*^9}},ExpressionUUID->"a86f0b7a-3566-4f2d-bc8f-\
8263370a281a"],

Cell["\<\
version=\[CloseCurlyDoubleQuote]remove\[CloseCurlyDoubleQuote];
quotareset=True;
rematch=True;\
\>", "Text",
 CellChangeTimes->{
  3.898906158227404*^9, 3.898928123024486*^9, {3.9019549704767985`*^9, 
   3.901955012945111*^9}},ExpressionUUID->"95668b4b-157e-41ca-911a-\
a824f815193e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "modifyR", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modifyR", "::", "usage"}], "=", 
   "\"\<modifyR[m_,u_List,d_List] \nmodifies m's market upstream and/or \
downstream members. As a consequence payoffMatrix, matchMatrix, quota are \
modified.\n\\\"quota_reset\\\"\[Rule]True The quota of the selected for \
remove streams becomes equal to 0 ( it's like these agents don't exist; all \
other matches stay the same).\n\\\"rematch\\\"\[Rule]True The matchMatrix of \
any given m'th market is re-calculated using the set quota; if rematch is not \
used, then the matching pairings in the market remain the same after whatever \
we applied to u and d in the previous steps. Attn: if we don't apply rematch, \
then the maximum contribution of an agent is equal to the payoff generated by \
the match.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modifyR", "[", 
    RowBox[{"m_", ",", "u_List", ",", "d_List"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"keep", ",", "theirdownstream", ",", "theirupstream"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"u", "!=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"quota", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "m", ",", "u"}], "]"}], "]"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "@", "u"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"matchMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "u"}], "]"}], "]"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "u", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"noD", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"Cmate", "[", "matchMatrix", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"d", "!=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"quota", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "m", ",", "d"}], "]"}], "]"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "@", "d"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"matchMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "All", ",", "d"}], "]"}], "]"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"noU", "[", 
              RowBox[{"[", "m", "]"}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "d", "]"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"Cmate", "[", "matchMatrix", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"CmatchMatrix", "[", 
       RowBox[{"payoffMatrix", ",", 
        RowBox[{"quota", "[", "\"\<upstream\>\"", "]"}], ",", 
        RowBox[{"quota", "[", "\"\<downstream\>\"", "]"}], ",", "m"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Cmate", "[", "matchMatrix", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Information", "[", 
  RowBox[{"modifyR", ",", 
   RowBox[{"LongForm", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6328520699689226`*^9, 3.6328520753595476`*^9}, {
   3.6328521130782976`*^9, 3.6328521150470476`*^9}, {3.6328521626251726`*^9, 
   3.6328522040470476`*^9}, {3.6328532282189226`*^9, 
   3.6328533037657976`*^9}, {3.6328534886876726`*^9, 
   3.6328535104376726`*^9}, {3.6328928664689727`*^9, 
   3.6328929266632504`*^9}, {3.6328929685441093`*^9, 
   3.6328929765079765`*^9}, {3.632908932389927*^9, 3.632908953300083*^9}, {
   3.632908983934849*^9, 3.6329090031965675`*^9}, {3.6329090374885597`*^9, 
   3.632909053037388*^9}, {3.6329326892167187`*^9, 3.632932922538721*^9}, {
   3.6329333340352297`*^9, 3.6329333408057375`*^9}, {3.6392251718614073`*^9, 
   3.6392251724239073`*^9}, {3.686929894619204*^9, 3.686929900557266*^9}, 
   3.686930406027337*^9, {3.686930458339118*^9, 3.68693056228625*^9}, {
   3.6869306708597116`*^9, 3.6869306793529453`*^9}, 3.686930862461831*^9, {
   3.709490182903656*^9, 3.709490193316196*^9}, {3.709544008381241*^9, 
   3.709544043304962*^9}, {3.709544211473461*^9, 3.7095442610718613`*^9}, {
   3.7095442938112297`*^9, 3.709544396864509*^9}, {3.709544470249008*^9, 
   3.709544598829364*^9}, {3.709544631223955*^9, 3.70954467711756*^9}, {
   3.709545025017789*^9, 3.7095450252288637`*^9}, {3.709545254109949*^9, 
   3.709545301656426*^9}, {3.709545447123825*^9, 3.709545614261239*^9}, {
   3.709545707727228*^9, 3.709545724288025*^9}, {3.70954606074331*^9, 
   3.709546067661819*^9}, {3.7095461355399323`*^9, 3.709546140003619*^9}, {
   3.709547988299377*^9, 3.7095480017641277`*^9}, {3.709548050739985*^9, 
   3.7095481394137373`*^9}, {3.709548182687681*^9, 3.709548189004834*^9}, {
   3.709548328116323*^9, 3.7095483480589952`*^9}, {3.709548545279161*^9, 
   3.709548587655821*^9}, {3.709548670850477*^9, 3.7095487112040443`*^9}, {
   3.710165469310959*^9, 3.7101655402404413`*^9}, {3.710165616356435*^9, 
   3.71016568522509*^9}, {3.7110046737728653`*^9, 3.711004682438507*^9}, {
   3.7110048029168077`*^9, 3.7110048066878366`*^9}, {3.7110048391945257`*^9, 
   3.711004894300302*^9}, {3.711004930842865*^9, 3.711004962859993*^9}, {
   3.711005043436014*^9, 3.711005046267044*^9}, {3.711005095100814*^9, 
   3.7110051611314383`*^9}, {3.7110063526785364`*^9, 
   3.7110063943494577`*^9}, {3.7110071520142517`*^9, 3.711007161417245*^9}, 
   3.71100721984261*^9, {3.711007657670189*^9, 3.711007729713994*^9}, {
   3.711010401316697*^9, 3.711010618922816*^9}, {3.7110106654080944`*^9, 
   3.7110107295697565`*^9}, {3.711011199644594*^9, 3.7110112002465143`*^9}, {
   3.7110134553878593`*^9, 3.7110136965572205`*^9}, {3.7110137819418097`*^9, 
   3.7110138259551764`*^9}, {3.7110210587356186`*^9, 
   3.7110211058659544`*^9}, {3.7110212835166235`*^9, 3.711021326420478*^9}, {
   3.711021685380116*^9, 3.711021688526653*^9}, 3.7110217598225718`*^9, {
   3.711021791309007*^9, 3.7110217944826307`*^9}, {3.7110225142899637`*^9, 
   3.71102252198413*^9}, {3.711022578939575*^9, 3.7110225967609215`*^9}, {
   3.711022628674158*^9, 3.711022659520808*^9}, {3.711022907554556*^9, 
   3.711022973728613*^9}, {3.7110232239227486`*^9, 3.711023292742097*^9}, {
   3.711023509838133*^9, 3.7110235839949975`*^9}, {3.71102449494153*^9, 
   3.7110245679263363`*^9}, {3.71143437035209*^9, 3.7114343757405157`*^9}, {
   3.7114434467956533`*^9, 3.711443457441277*^9}, 3.711443851997761*^9, {
   3.711444265293215*^9, 3.711444340983265*^9}, {3.7114448542454453`*^9, 
   3.711444913705699*^9}, {3.711873665516185*^9, 3.71187377253406*^9}, {
   3.711873986454157*^9, 3.711873996738405*^9}, {3.71187426188697*^9, 
   3.711874308955492*^9}, {3.711875043854862*^9, 3.711875239934822*^9}, {
   3.711875276753846*^9, 3.711875317496395*^9}, {3.7118753625881023`*^9, 
   3.711875420171657*^9}, {3.7118754754261417`*^9, 3.71187555421609*^9}, {
   3.711875903160631*^9, 3.711875928408846*^9}, {3.7118760070327187`*^9, 
   3.711876007205378*^9}, {3.71187607377666*^9, 3.711876082111889*^9}, {
   3.7118763866150637`*^9, 3.711876395299238*^9}, {3.711876438801803*^9, 
   3.711876508374796*^9}, {3.711876561860174*^9, 3.711876565238696*^9}, {
   3.711877438803721*^9, 3.71187745805984*^9}, {3.711877679243475*^9, 
   3.711877687960745*^9}, 3.711878258815971*^9, {3.711878454983542*^9, 
   3.711878570504196*^9}, {3.7118786240316343`*^9, 3.7118786578778553`*^9}, {
   3.7118792398217983`*^9, 3.711879288437495*^9}, {3.7177252248529253`*^9, 
   3.7177252509530687`*^9}, {3.751694981652031*^9, 3.751694984796842*^9}, {
   3.751695071813501*^9, 3.751695103052786*^9}, {3.751695135210373*^9, 
   3.751695160425458*^9}, {3.751695350994014*^9, 3.751695365449587*^9}, {
   3.751695556725955*^9, 3.751695561419487*^9}, {3.751695667864646*^9, 
   3.7516957072615137`*^9}, {3.751695746772884*^9, 3.751695859327167*^9}, {
   3.7516959313479443`*^9, 3.751695997475194*^9}, {3.751696127153687*^9, 
   3.751696240497492*^9}, {3.751697630128653*^9, 3.751697632503696*^9}, {
   3.75169776847292*^9, 3.751697867008768*^9}, 3.7516980288874197`*^9, {
   3.751954888477621*^9, 3.7519549297014647`*^9}, 3.751955023050892*^9, {
   3.751955345313078*^9, 3.751955351019239*^9}, 3.751958054359799*^9, {
   3.8980370684367237`*^9, 3.898037274244433*^9}, {3.8980373105852833`*^9, 
   3.89803736404816*^9}, {3.8980375581705513`*^9, 3.898037569618383*^9}, 
   3.898037629389954*^9, {3.898055365077405*^9, 3.898055374855847*^9}, {
   3.9019550628867254`*^9, 3.901955081993783*^9}, {3.901955126725675*^9, 
   3.9019551806855755`*^9}},
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[28]:=",ExpressionUUID->"2f23cbd4-a653-4e65-8dc5-45774a384026"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"modifyR[m_,u_List,d_List] \\nmodifies m's market \
upstream and/or downstream members. As a consequence payoffMatrix, \
matchMatrix, quota are modified.\\n\\\"quota_reset\\\"\[Rule]True The quota \
of the selected for remove streams becomes equal to 0 ( it's like these \
agents don't exist; all other matches stay the \
same).\\n\\\"rematch\\\"\[Rule]True The matchMatrix of any given m'th market \
is re-calculated using the set quota; if rematch is not used, then the \
matching pairings in the market remain the same after whatever we applied to \
u and d in the previous steps. Attn: if we don't apply rematch, then the \
maximum contribution of an agent is equal to the payoff generated by the \
match.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"modifyR", "[", 
                    RowBox[{"m_", ",", "u_List", ",", "d_List"}], "]"}], ":=", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"keep", ",", "theirdownstream", ",", 
                    "theirupstream"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"u", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"quota", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "m", ",", "u"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "u", "]"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"matchMatrix", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "u"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "u", "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    
                    RowBox[{"noD", "\[LeftDoubleBracket]", "m", 
                    "\[RightDoubleBracket]"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"Cmate", "[", "matchMatrix", "]"}], ";"}]}], 
                    "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"d", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"quota", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "m", ",", "d"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "d", "]"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"matchMatrix", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "All", ",", "d"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    
                    RowBox[{"noU", "\[LeftDoubleBracket]", "m", 
                    "\[RightDoubleBracket]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "d", "]"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"Cmate", "[", "matchMatrix", "]"}], ";"}]}], 
                    "]"}], ";", 
                    RowBox[{"CmatchMatrix", "[", 
                    RowBox[{"payoffMatrix", ",", 
                    RowBox[{"quota", "[", "\"upstream\"", "]"}], ",", 
                    RowBox[{"quota", "[", "\"downstream\"", "]"}], ",", "m"}],
                     "]"}], ";", 
                    RowBox[{"Cmate", "[", "matchMatrix", "]"}], ";"}]}], 
                    "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"Global`modifyR\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"modifyR[m_,u_List,d_List] \\nmodifies m's market \
upstream and/or downstream members. As a consequence payoffMatrix, \
matchMatrix, quota are modified.\\n\\\"quota_reset\\\"\[Rule]True The quota \
of the selected for remove streams becomes equal to 0 ( it's like these \
agents don't exist; all other matches stay the \
same).\\n\\\"rematch\\\"\[Rule]True The matchMatrix of any given m'th market \
is re-calculated using the set quota; if rematch is not used, then the \
matching pairings in the market remain the same after whatever we applied to \
u and d in the previous steps. Attn: if we don't apply rematch, then the \
maximum contribution of an agent is equal to the payoff generated by the \
match.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{12.5, {4., 8.5}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{12.5, {4., 8.5}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "modifyR[m_,u_List,d_List] \nmodifies m's market upstream and/or \
downstream members. As a consequence payoffMatrix, matchMatrix, quota are \
modified.\n\"quota_reset\"\[Rule]True The quota of the selected for remove \
streams becomes equal to 0 ( it's like these agents don't exist; all other \
matches stay the same).\n\"rematch\"\[Rule]True The matchMatrix of any given \
m'th market is re-calculated using the set quota; if rematch is not used, \
then the matching pairings in the market remain the same after whatever we \
applied to u and d in the previous steps. Attn: if we don't apply rematch, \
then the maximum contribution of an agent is equal to the payoff generated by \
the match.", "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None,
     "DownValues" -> 
    Information`InformationValueForm[
     DownValues, $CellContext`modifyR, {$CellContext`modifyR[
         Pattern[$CellContext`m, 
          Blank[]], 
         Pattern[$CellContext`u, 
          Blank[List]], 
         Pattern[$CellContext`d, 
          Blank[List]]] :> 
       Block[{$CellContext`keep, $CellContext`theirdownstream, \
$CellContext`theirupstream}, 
         If[$CellContext`u != {}, 
           Part[$CellContext`quota, 1, $CellContext`m, $CellContext`u] = 
            Table[0, {
               Length[$CellContext`u]}]; 
           Part[$CellContext`matchMatrix, $CellContext`m, $CellContext`u] = 
            Table[0, {
               Length[$CellContext`u]}, {
               
               Part[$CellContext`noD, $CellContext`m]}]; \
$CellContext`Cmate[$CellContext`matchMatrix]; Null]; 
         If[$CellContext`d != {}, 
           Part[$CellContext`quota, 2, $CellContext`m, $CellContext`d] = 
            Table[0, {
               Length[$CellContext`d]}]; 
           Part[$CellContext`matchMatrix, $CellContext`m, 
              All, $CellContext`d] = Table[0, {
               Part[$CellContext`noU, $CellContext`m]}, {
               
               Length[$CellContext`d]}]; \
$CellContext`Cmate[$CellContext`matchMatrix]; 
           Null]; $CellContext`CmatchMatrix[$CellContext`payoffMatrix, 
           $CellContext`quota["upstream"], 
           $CellContext`quota[
           "downstream"], $CellContext`m]; \
$CellContext`Cmate[$CellContext`matchMatrix]; Null]}], "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> "Global`modifyR"], 
   False]]], "Output",
 CellChangeTimes->{3.9061780559561305`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"99c1ba1a-8191-4d4b-bb6c-27629ef5782c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["5. Calculates the contribution intervals according to \
the modifyR function",
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Subsection",
 CellChangeTimes->{{3.870061553608951*^9, 3.870061554186017*^9}, {
   3.901955363048105*^9, 3.9019553901592326`*^9}, {3.901955513809389*^9, 
   3.9019555329302087`*^9}, 
   3.9038614351633816`*^9},ExpressionUUID->"c550463b-0ffd-4ded-b145-\
a19c883322ff"],

Cell[TextData[StyleBox["Calculates the contribution intervals iteratively, \
running across all removeu and removedd\nBelow, ures1 shows the list of \
triplets {marketid, removeup id; maximum contribution of the corresponding \
removeup id}; likewise, dres1 containts the list of triplets {marketid, \
removedown id, maximum contribution of the corresponding removedown id}. ",
 FontFamily->"Consolas",
 FontSize->14,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Text",
 CellChangeTimes->{{3.898906196222375*^9, 3.89890624165567*^9}, {
   3.9019552653792334`*^9, 3.9019553014144173`*^9}, {3.904228505321434*^9, 
   3.904228521759418*^9}, {3.9042288722126675`*^9, 3.9042289494627633`*^9}, 
   3.904364026903493*^9},ExpressionUUID->"b6cf214e-c985-4c29-87b3-\
e713cd1ac9e1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"umatchesheader", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"dmatchesheader", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"umatches", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"dmatches", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ures1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"restore", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"modifyR", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"umatchesheader", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<U\>\"", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"umatches", ",", 
         RowBox[{"Flatten", "@", "matchMatrix"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"stored", "[", "\"\<totalpayoff\>\"", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Ctotalpayoff", "[", 
             RowBox[{"payoffMatrix", ",", 
              RowBox[{"Cmates", "[", "matchMatrix", "]"}]}], "]"}], ")"}], 
           "[", 
           RowBox[{"[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], "&"}], "/@",
     "removeu"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dres1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"restore", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"modifyR", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"dmatchesheader", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<D\>\"", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"dmatches", ",", 
          RowBox[{"Flatten", "@", "matchMatrix"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"stored", "[", "\"\<totalpayoff\>\"", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Ctotalpayoff", "[", 
              RowBox[{"payoffMatrix", ",", 
               RowBox[{"Cmates", "[", "matchMatrix", "]"}]}], "]"}], ")"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], "&"}], 
     "/@", "removed"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<ures1=\>\"", ",", "ures1"}], "]"}], ";", 
  RowBox[{"Print", "[", 
   RowBox[{"\"\<dres1=\>\"", ",", "dres1"}], "]"}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Length", "@", "ures1"}], ",", 
    RowBox[{"Length", "@", "dres1"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.870061566018289*^9, 3.8700616014708357`*^9}, {
  3.897718465286963*^9, 3.89771850233809*^9}, {3.8979841575323133`*^9, 
  3.897984170789509*^9}, {3.8980367931393633`*^9, 3.898036828609489*^9}, {
  3.898037407183321*^9, 3.898037466228126*^9}, {3.898907269426437*^9, 
  3.89890727443017*^9}, {3.898934531567459*^9, 3.898934538075143*^9}, {
  3.898936345928101*^9, 3.898936365621706*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"dab29fb0-8115-477d-830e-6ba293d817db"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ures1=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "3.261881937695513`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6", ",", "14.9839583194926`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "3.834775329160088`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "14.418994868220466`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "7.648896888679829`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "24.16841802470332`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "2", ",", "5.406986999054624`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "4", ",", "5.829676462867624`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "6", ",", "6.341462281022412`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "1", ",", "5.0323753430614175`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "2", ",", "6.132567018032631`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "4", ",", "6.49698414714544`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "4", ",", "8.03575555651748`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "4", ",", "5.236684082261121`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "3", ",", "11.899849104927625`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "6", ",", "4.949462767981743`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "12", ",", "11.563799831216443`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "2", ",", "14.813395084755655`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "8", ",", "11.126249580383416`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "3", ",", "4.251944259857595`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "1", ",", "1.7456144400323694`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "2", ",", "3.3205746267091882`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "5", ",", "3.9973204127185653`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "1", ",", "12.237444393735643`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "2", ",", "3.61505768191509`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "12", ",", "9.794609453429672`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2", ",", "6.226175231451268`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "2", ",", "7.279605309878775`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "6", ",", "6.147706533233261`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "1", ",", "5.519449034975253`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "2", ",", "4.547598240145035`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "5", ",", "3.040740624409807`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "13", ",", "11.214673283188873`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "6", ",", "7.252719216934452`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "7", ",", "7.986989501243812`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "1", ",", "13.338463291701203`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "3", ",", "4.458717517699995`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "11", ",", "6.598082791603332`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "1", ",", "11.05044617821207`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "3", ",", "3.311556778454502`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "16", ",", "5.006314183952469`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"21", ",", "2", ",", "3.958089577400898`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"21", ",", "6", ",", "4.457468043579041`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"22", ",", "3", ",", "5.013592494398694`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"22", ",", "14", ",", "3.6380243900229488`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"23", ",", "3", ",", "4.842875628539687`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"23", ",", "7", ",", "4.888561916057483`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"24", ",", "1", ",", "5.3949655248164845`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"24", ",", "9", ",", "3.1291248582959525`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "2", ",", "10.356964105336488`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "7", ",", "21.38088727800192`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "14", ",", "27.035167800198536`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "1", ",", "8.345932715208534`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "5", ",", "4.2852287462678476`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "12", ",", "10.98598819305252`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"27", ",", "8", ",", "7.077719894182906`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "2", ",", "3.5221321798618703`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "6", ",", "3.271487990534169`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "8", ",", "4.355189210621063`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "2", ",", "4.87563701068089`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "5", ",", "6.516069590365589`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "18", ",", "4.976584090495649`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "21", ",", "4.706020570291415`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"30", ",", "6", ",", "1.8913355055320196`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "6", ",", "17.00429191077474`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "12", ",", "5.589979290028481`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "13", ",", "4.317715323871184`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "14", ",", "13.349627518504803`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"32", ",", "16", ",", "4.679553330292492`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"32", ",", "25", ",", "6.910075041306868`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33", ",", "6", ",", "6.811241767546228`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33", ",", "7", ",", "4.273078200608261`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33", ",", "9", ",", "2.6242668918937753`"}], "}"}]}], "}"}]}],
  SequenceForm[
  "ures1=", {{1, 4, 3.261881937695513}, {2, 6, 14.9839583194926}, {
    3, 5, 3.834775329160088}, {4, 1, 14.418994868220466`}, {
    4, 2, 7.648896888679829}, {4, 4, 24.16841802470332}, {
    5, 2, 5.406986999054624}, {5, 4, 5.829676462867624}, {
    6, 6, 6.341462281022412}, {7, 1, 5.0323753430614175`}, {
    7, 2, 6.132567018032631}, {7, 4, 6.49698414714544}, {
    8, 4, 8.03575555651748}, {9, 4, 5.236684082261121}, {
    10, 3, 11.899849104927625`}, {10, 6, 4.949462767981743}, {
    10, 12, 11.563799831216443`}, {11, 2, 14.813395084755655`}, {
    11, 8, 11.126249580383416`}, {12, 3, 4.251944259857595}, {
    13, 1, 1.7456144400323694`}, {13, 2, 3.3205746267091882`}, {
    13, 5, 3.9973204127185653`}, {14, 1, 12.237444393735643`}, {
    14, 2, 3.61505768191509}, {14, 12, 9.794609453429672}, {
    15, 2, 6.226175231451268}, {16, 2, 7.279605309878775}, {
    16, 6, 6.147706533233261}, {17, 1, 5.519449034975253}, {
    17, 2, 4.547598240145035}, {17, 5, 3.040740624409807}, {
    17, 13, 11.214673283188873`}, {18, 6, 7.252719216934452}, {
    18, 7, 7.986989501243812}, {19, 1, 13.338463291701203`}, {
    19, 3, 4.458717517699995}, {19, 11, 6.598082791603332}, {
    20, 1, 11.05044617821207}, {20, 3, 3.311556778454502}, {
    20, 16, 5.006314183952469}, {21, 2, 3.958089577400898}, {
    21, 6, 4.457468043579041}, {22, 3, 5.013592494398694}, {
    22, 14, 3.6380243900229488`}, {23, 3, 4.842875628539687}, {
    23, 7, 4.888561916057483}, {24, 1, 5.3949655248164845`}, {
    24, 9, 3.1291248582959525`}, {25, 2, 10.356964105336488`}, {
    25, 7, 21.38088727800192}, {25, 14, 27.035167800198536`}, {
    26, 1, 8.345932715208534}, {26, 5, 4.2852287462678476`}, {
    26, 12, 10.98598819305252}, {27, 8, 7.077719894182906}, {
    28, 2, 3.5221321798618703`}, {28, 6, 3.271487990534169}, {
    28, 8, 4.355189210621063}, {29, 2, 4.87563701068089}, {
    29, 5, 6.516069590365589}, {29, 18, 4.976584090495649}, {
    29, 21, 4.706020570291415}, {30, 6, 1.8913355055320196`}, {
    31, 6, 17.00429191077474}, {31, 12, 5.589979290028481}, {
    31, 13, 4.317715323871184}, {31, 14, 13.349627518504803`}, {
    32, 16, 4.679553330292492}, {32, 25, 6.910075041306868}, {
    33, 6, 6.811241767546228}, {33, 7, 4.273078200608261}, {
    33, 9, 2.6242668918937753`}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.906178064444449*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"901a036d-d542-406d-83d3-9ee735e36078"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dres1=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "9", ",", "7.848456847989496`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "6", ",", "7.218792184510647`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "13", ",", "7.219059889460226`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "6.75261729003072`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "6.6768597249219255`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3", ",", "7.586172939776304`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "7.357735623323279`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6", ",", "9.087150417312259`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "9", ",", "7.999782857735269`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "12", ",", "8.139518303392492`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "7", ",", "4.509605568434203`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "8", ",", "4.7745521769839385`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "1", ",", "7.275681152954398`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "3", ",", "5.387265075901716`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "5", ",", "3.8875870292251165`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "8", ",", "4.6550297767921975`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "1", ",", "6.262742508786644`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "2", ",", "5.980072287865681`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "5.362419447102326`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "7", ",", "5.077636214878439`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "8", ",", "6.129005684955061`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "13", ",", "4.763690884803623`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "15", ",", "7.463259059320265`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "5", ",", "4.467971380422654`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "7", ",", "4.001950364364717`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "8", ",", "2.9940505436794638`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "10", ",", "4.982194593423742`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "17", ",", "1.3580607533874058`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "8", ",", "6.701731909715029`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "2", ",", "7.1859710455425585`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "7", ",", "2.6041462371182433`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "13", ",", "6.088426028846868`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "3", ",", "3.307893524207344`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "10", ",", "5.627639938346562`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "11", ",", "2.6838017673906336`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "15", ",", "4.781838254061796`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "16", ",", "2.7456206991836325`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "17", ",", "3.230493761369331`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2", ",", "5.016242725113216`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "3", ",", "4.130923311424311`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "4", ",", "2.291081117454894`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "14", ",", "3.6102270884921523`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "15", ",", "3.9438554907323464`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "1", ",", "5.602423886020148`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "2", ",", "5.285996940754245`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "10", ",", "6.235826167766419`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "12", ",", "4.0922395934604765`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "14", ",", "4.3874253331971005`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "2", ",", "7.05601553821738`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "16", ",", "7.1470613131482`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "2", ",", "5.4666674565435756`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "7", ",", "5.15700768430753`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "11", ",", "4.906185284593818`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "12", ",", "5.5162858171377565`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "2", ",", "6.388238242204125`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "9", ",", "6.268839110254049`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "11", ",", "5.106649455061785`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "14", ",", "5.1925047544873735`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"21", ",", "5", ",", "2.9198818764615595`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"21", ",", "6", ",", "4.668030895300134`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"22", ",", "16", ",", "4.599292137658352`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"22", ",", "21", ",", "3.6100872257290604`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"23", ",", "6", ",", "5.973796883130802`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"23", ",", "16", ",", "5.247607058892072`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"24", ",", "2", ",", "3.147044488878464`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"24", ",", "4", ",", "5.707340052236468`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "4", ",", "2.9686717321042693`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "9", ",", "2.407927980033975`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "15", ",", "3.0380392686965365`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "17", ",", "4.182522002495432`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "19", ",", "5.282232203359371`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "20", ",", "5.421046262926978`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "21", ",", "4.14856415142188`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "24", ",", "3.685903295604845`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "26", ",", "4.062935431782847`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "27", ",", "2.086149370649167`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "2", ",", "4.517360799832119`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "11", ",", "4.843214226208971`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "29", ",", "7.654970550604816`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "36", ",", "6.07919079714631`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"26", ",", "37", ",", "7.245776559042184`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"27", ",", "5", ",", "4.949897172298918`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "8", ",", "4.963268466708115`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "11", ",", "1.4492952119770308`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "21", ",", "5.699498011270862`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "3", ",", "4.053531319868199`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "18", ",", "4.899349062374398`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "23", ",", "5.109701513914985`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"29", ",", "24", ",", "4.546149513288597`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"30", ",", "4", ",", "6.628016724558535`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "1", ",", "3.974260074989502`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "2", ",", "5.252344398825443`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "4", ",", "5.086163344555473`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "8", ",", "4.384816056706029`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "12", ",", "4.0435952400411`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "16", ",", "5.671649998598028`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "18", ",", "2.6201294001244975`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"31", ",", "22", ",", "3.0596094752576306`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"32", ",", "8", ",", "4.653519885316257`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"32", ",", "21", ",", "5.814246476160633`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"32", ",", "27", ",", "5.110836437675971`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33", ",", "2", ",", "7.364903776624445`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33", ",", "5", ",", "1.5574539286760967`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33", ",", "7", ",", "6.02345026730864`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"33", ",", "12", ",", "3.704929539671255`"}], "}"}]}], "}"}]}],
  SequenceForm[
  "dres1=", {{1, 9, 7.848456847989496}, {2, 6, 7.218792184510647}, {
    2, 13, 7.219059889460226}, {3, 5, 6.75261729003072}, {
    4, 1, 6.6768597249219255`}, {4, 3, 7.586172939776304}, {
    4, 5, 7.357735623323279}, {4, 6, 9.087150417312259}, {
    4, 9, 7.999782857735269}, {4, 12, 8.139518303392492}, {
    5, 7, 4.509605568434203}, {5, 8, 4.7745521769839385`}, {
    6, 1, 7.275681152954398}, {7, 3, 5.387265075901716}, {
    7, 5, 3.8875870292251165`}, {7, 8, 4.6550297767921975`}, {
    8, 1, 6.262742508786644}, {9, 2, 5.980072287865681}, {
    10, 1, 5.362419447102326}, {10, 7, 5.077636214878439}, {
    10, 8, 6.129005684955061}, {10, 13, 4.763690884803623}, {
    10, 15, 7.463259059320265}, {11, 5, 4.467971380422654}, {
    11, 7, 4.001950364364717}, {11, 8, 2.9940505436794638`}, {
    11, 10, 4.982194593423742}, {11, 17, 1.3580607533874058`}, {
    12, 8, 6.701731909715029}, {13, 2, 7.1859710455425585`}, {
    13, 7, 2.6041462371182433`}, {13, 13, 6.088426028846868}, {
    14, 3, 3.307893524207344}, {14, 10, 5.627639938346562}, {
    14, 11, 2.6838017673906336`}, {14, 15, 4.781838254061796}, {
    14, 16, 2.7456206991836325`}, {14, 17, 3.230493761369331}, {
    15, 2, 5.016242725113216}, {16, 3, 4.130923311424311}, {
    16, 4, 2.291081117454894}, {16, 14, 3.6102270884921523`}, {
    16, 15, 3.9438554907323464`}, {17, 1, 5.602423886020148}, {
    17, 2, 5.285996940754245}, {17, 10, 6.235826167766419}, {
    17, 12, 4.0922395934604765`}, {17, 14, 4.3874253331971005`}, {
    18, 2, 7.05601553821738}, {18, 16, 7.1470613131482}, {
    19, 2, 5.4666674565435756`}, {19, 7, 5.15700768430753}, {
    19, 11, 4.906185284593818}, {19, 12, 5.5162858171377565`}, {
    20, 2, 6.388238242204125}, {20, 9, 6.268839110254049}, {
    20, 11, 5.106649455061785}, {20, 14, 5.1925047544873735`}, {
    21, 5, 2.9198818764615595`}, {21, 6, 4.668030895300134}, {
    22, 16, 4.599292137658352}, {22, 21, 3.6100872257290604`}, {
    23, 6, 5.973796883130802}, {23, 16, 5.247607058892072}, {
    24, 2, 3.147044488878464}, {24, 4, 5.707340052236468}, {
    25, 4, 2.9686717321042693`}, {25, 9, 2.407927980033975}, {
    25, 15, 3.0380392686965365`}, {25, 17, 4.182522002495432}, {
    25, 19, 5.282232203359371}, {25, 20, 5.421046262926978}, {
    25, 21, 4.14856415142188}, {25, 24, 3.685903295604845}, {
    25, 26, 4.062935431782847}, {25, 27, 2.086149370649167}, {
    26, 2, 4.517360799832119}, {26, 11, 4.843214226208971}, {
    26, 29, 7.654970550604816}, {26, 36, 6.07919079714631}, {
    26, 37, 7.245776559042184}, {27, 5, 4.949897172298918}, {
    28, 8, 4.963268466708115}, {28, 11, 1.4492952119770308`}, {
    28, 21, 5.699498011270862}, {29, 3, 4.053531319868199}, {
    29, 18, 4.899349062374398}, {29, 23, 5.109701513914985}, {
    29, 24, 4.546149513288597}, {30, 4, 6.628016724558535}, {
    31, 1, 3.974260074989502}, {31, 2, 5.252344398825443}, {
    31, 4, 5.086163344555473}, {31, 8, 4.384816056706029}, {
    31, 12, 4.0435952400411}, {31, 16, 5.671649998598028}, {
    31, 18, 2.6201294001244975`}, {31, 22, 3.0596094752576306`}, {
    32, 8, 4.653519885316257}, {32, 21, 5.814246476160633}, {
    32, 27, 5.110836437675971}, {33, 2, 7.364903776624445}, {
    33, 5, 1.5574539286760967`}, {33, 7, 6.02345026730864}, {
    33, 12, 3.704929539671255}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.9061780645102725`*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"443f6fa9-8434-425e-a917-7713ecb6a8c6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"73", ",", "105"}], "}"}]], "Output",
 CellChangeTimes->{3.9061780645631323`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"3f9af178-cf91-41f4-b20c-38357cf0ca4d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["6. Generates output",
 FontFamily->"Consolas",
 FontSize->18,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Subsection",
 CellChangeTimes->{{3.870061913317432*^9, 3.870061913982623*^9}, {
   3.871038869777933*^9, 3.871038875390689*^9}, {3.90195554729823*^9, 
   3.9019555477128696`*^9}, 
   3.9038614909638543`*^9},ExpressionUUID->"28eec9f2-befe-441d-9ac1-\
8c6313a863ca"],

Cell[TextData[StyleBox["The code exports 2 files: The first output file keeps \
only agents for which we calculated the contribution intervals. In the paper, \
this output file shows the contribution intervals of \
\[OpenCurlyDoubleQuote]star PIs\[CloseCurlyDoubleQuote] in the data.The \
summary statistics are reported in Table 3a. \n\nFor the interested user, the \
code also exports a second file, containing all agents in the original input \
data (that is, all star and non-star PIs). This output file contains several \
columns that indicate who matches with whom after an agent is removed from \
the market. For example, the column called \[OpenCurlyDoubleQuote]{U, 33, 6}\
\[CloseCurlyDoubleQuote] takes the value of 1 for the matches that are formed \
in market 33 after upstream 6 was \[OpenCurlyDoubleQuote]removed\
\[CloseCurlyDoubleQuote] (i.e. its quota was set to zero) from the market. \
Likewise, the column called \[OpenCurlyDoubleQuote]{D, 33, 2}\
\[CloseCurlyDoubleQuote] takes the value of 1 for all matches formed in \
market 33 after downstream 2 was \[OpenCurlyDoubleQuote]removed\
\[CloseCurlyDoubleQuote] (i.e. its quota was set to zero) from the market. \
This information is important for understanding who the \
\[OpenCurlyDoubleQuote]next best match\[CloseCurlyDoubleQuote] of an agent \
is. See section 5.3 (\[OpenCurlyDoubleQuote]Post-hoc analysis\
\[CloseCurlyDoubleQuote]) in the paper for a discussion.",
 FontFamily->"Consolas",
 FontSize->14,
 FontWeight->"Normal",
 FontColor->RGBColor[0.5019607843137255, 0., 0.]]], "Text",
 CellChangeTimes->{{3.8989321824297953`*^9, 3.8989322451447887`*^9}, {
   3.901955554699839*^9, 3.9019555678309245`*^9}, {3.901955598705855*^9, 
   3.901955894260438*^9}, {3.901955932588616*^9, 3.901956082759183*^9}, {
   3.9019561799795*^9, 3.901956250435975*^9}, {3.901957306571853*^9, 
   3.901957402770013*^9}, {3.901957499476576*^9, 3.9019575745955386`*^9}, {
   3.903861565394128*^9, 3.903861663101025*^9}, {3.903861769645957*^9, 
   3.9038617760674567`*^9}, {3.903861823538628*^9, 3.9038618945855503`*^9}, {
   3.904228574501278*^9, 3.9042287714158792`*^9}, {3.90422959699207*^9, 
   3.904229669058277*^9}, {3.90422974465191*^9, 3.9042297853918886`*^9}, {
   3.9043640893170147`*^9, 3.9043640967129545`*^9}, 
   3.9043641306801343`*^9},ExpressionUUID->"cbb94802-e602-4106-a3ab-\
292c80f3a395"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "exportfilename", "=", " ", "\"\<../data/modifyR-output-stars\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ur1", "=", 
   RowBox[{"GroupBy", "[", 
    RowBox[{"ures1", ",", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dr1", "=", 
    RowBox[{"GroupBy", "[", 
     RowBox[{"dres1", ",", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "2"}], "]"}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "u", ",", "d", ",", 
          RowBox[{"payoffMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "u", ",", "d"}], "]"}], "]"}], ",", 
          RowBox[{"originalmatchMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"m", ",", "u", ",", "d"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"ur1", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "u"}], "}"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", "tmp"}], "===", "Missing"}], ",", 
             "\"\<\>\"", ",", 
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", 
               RowBox[{"tmp", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(*", "urmax", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"dr1", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "d"}], "}"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", "tmp"}], "===", "Missing"}], ",", 
             "\"\<\>\"", ",", 
             RowBox[{"Max", "[", 
              RowBox[{"0", ",", 
               RowBox[{"tmp", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(*", "drmax", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"dr1", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "d"}], "}"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", "tmp"}], "===", "Missing"}], ",", 
             "\"\<\>\"", ",", 
             RowBox[{
              RowBox[{"tmp", "=", 
               RowBox[{
                RowBox[{"payoffMatrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "u", ",", "d"}], "]"}], "]"}], "-", 
                RowBox[{"tmp", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"tmp", "<", "0"}], ",", "0", ",", "tmp"}], "]"}]}]}], 
            "]"}]}], ",", 
          RowBox[{"(*", "urmin", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tmp", "=", 
            RowBox[{"ur1", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "u"}], "}"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", "tmp"}], "===", "Missing"}], ",", 
             "\"\<\>\"", ",", 
             RowBox[{
              RowBox[{"tmp", "=", 
               RowBox[{
                RowBox[{"payoffMatrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "u", ",", "d"}], "]"}], "]"}], "-", 
                RowBox[{"tmp", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"tmp", "<", "0"}], ",", "0", ",", "tmp"}], "]"}]}]}], 
            "]"}]}]}], 
         RowBox[{"(*", "drmin", "*)"}], "\[IndentingNewLine]", "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "noM"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", 
          RowBox[{"noU", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", 
          RowBox[{"noD", "[", 
           RowBox[{"[", "m", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v1", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", "data"}], ",", 
       RowBox[{"Transpose", "@", "removes"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Number of instances where urmin > drmax: \>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Count", "[", 
     RowBox[{"v1", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"__", ",", "originalmatch_", ",", "urmax_", ",", 
         RowBox[{"drmax_", "?", "NumberQ"}], ",", 
         RowBox[{"urmin_", "?", "NumberQ"}], ",", "drmin_", ",", "removeU_", 
         ",", "removeD_"}], "}"}], "/;", 
       RowBox[{
        RowBox[{"originalmatch", "\[Equal]", "1"}], "&&", 
        RowBox[{"removeU", "\[Equal]", "1"}], "&&", 
        RowBox[{"urmin", ">", "drmax"}]}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Number of instances where drmin > urmax: \>\"", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Count", "[", 
      RowBox[{"v1", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"__", ",", "originalmatch_", ",", 
          RowBox[{"urmax_", "?", "NumberQ"}], ",", "drmax_", ",", "urmin_", 
          ",", 
          RowBox[{"drmin_", "?", "NumberQ"}], ",", "removeU_", ",", 
          "removeD_"}], "}"}], "/;", 
        RowBox[{
         RowBox[{"originalmatch", "\[Equal]", "1"}], "&&", 
         RowBox[{"removeD", "\[Equal]", "1"}], "&&", 
         RowBox[{"drmin", ">", "urmax"}]}]}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"we", " ", "are", " ", "keeping", " ", "removeU"}], "==", 
    RowBox[{"1", " ", "and", " ", "originalMatch"}], "==", "1"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"writeYourTSV", "[", 
   RowBox[{
    RowBox[{"exportfilename", "<>", "\"\<.remove.originalmatch.dat\>\""}], 
    ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"v1", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "1"}], " ", "&&", 
           " ", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "10", "]"}], "]"}], "\[Equal]", "1"}]}], ")"}], 
         "&"}]}], "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"header", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<payoff\>\"", ",", "\"\<originalmatch\>\"", ",", "\"\<urmax\>\"",
           ",", "\"\<drmax\>\"", ",", "\"\<urmin\>\"", ",", "\"\<drmin\>\"", 
          ",", "\"\<removeU\>\"", ",", "\"\<removeD\>\""}], "}"}]}], "]"}]}], 
     "]"}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v2", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", "data"}], ",", 
       RowBox[{"Transpose", "@", "removes"}], ",", "\[IndentingNewLine]", 
       RowBox[{"umatches", "[", 
        RowBox[{"[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"umatchesheader", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<U\>\"", ",", "m_", ",", "u_"}], "}"}], " ", "/;", 
             " ", 
             RowBox[{"m", "\[Equal]", "exportmatch"}]}]}], "]"}], "]"}], 
         "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"dmatches", "[", 
        RowBox[{"[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"dmatchesheader", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<D\>\"", ",", "m_", ",", "d_"}], "}"}], " ", "/;", 
             " ", 
             RowBox[{"m", "\[Equal]", "exportmatch"}]}]}], "]"}], "]"}], 
         "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"writeYourTSV", "[", 
  RowBox[{
   RowBox[{"exportfilename", "<>", "\"\<.all.dat\>\""}], ",", 
   RowBox[{"Prepend", "[", 
    RowBox[{"v2", ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"header", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<payoff\>\"", ",", "\"\<originalmatch\>\"", ",", "\"\<urmax\>\"", 
         ",", "\"\<drmax\>\"", ",", "\"\<urmin\>\"", ",", "\"\<drmin\>\"", 
         ",", "\"\<removeU\>\"", ",", "\"\<removeD\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ToString", "/@", 
        RowBox[{"(", 
         RowBox[{"umatchesheader", "[", 
          RowBox[{"[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"umatchesheader", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<U\>\"", ",", "m_", ",", "u_"}], "}"}], " ", "/;",
                " ", 
               RowBox[{"m", "\[Equal]", "exportmatch"}]}]}], "]"}], "]"}], 
           "]"}], "]"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ToString", "/@", 
        RowBox[{"(", 
         RowBox[{"dmatchesheader", "[", 
          RowBox[{"[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"dmatchesheader", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<D\>\"", ",", "m_", ",", "d_"}], "}"}], " ", "/;",
                " ", 
               RowBox[{"m", "\[Equal]", "exportmatch"}]}]}], "]"}], "]"}], 
           "]"}], "]"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.8700619432190332`*^9, {3.897718535733117*^9, 3.897718602280136*^9}, {
   3.897718707446797*^9, 3.897718787179407*^9}, {3.8977188724002247`*^9, 
   3.8977188786498423`*^9}, {3.897721545714172*^9, 3.897721572101532*^9}, {
   3.897721615325519*^9, 3.897721701773683*^9}, {3.8977217813523607`*^9, 
   3.89772181541829*^9}, {3.8977219446202173`*^9, 3.897721990912375*^9}, {
   3.897722118827879*^9, 3.897722181677019*^9}, 3.8979842391441317`*^9, {
   3.897984725123064*^9, 3.8979847301500483`*^9}, {3.897984775854747*^9, 
   3.8979848278788443`*^9}, {3.898035890974884*^9, 3.898035891922472*^9}, {
   3.898035939943653*^9, 3.898035942886582*^9}, {3.89803598009031*^9, 
   3.898036019704936*^9}, {3.898036118715206*^9, 3.898036195619657*^9}, {
   3.898036309169929*^9, 3.898036331823324*^9}, {3.898036543771002*^9, 
   3.898036555352113*^9}, {3.898036593179991*^9, 3.898036642841671*^9}, {
   3.898036690835249*^9, 3.898036691219434*^9}, {3.898036947980652*^9, 
   3.898036950385951*^9}, 3.8989072515444813`*^9, {3.898936481499045*^9, 
   3.898936517826995*^9}, {3.9038645702085247`*^9, 3.9038645732410135`*^9}, {
   3.9038672023324337`*^9, 3.903867204823937*^9}, {3.903867263164494*^9, 
   3.903867270226173*^9}, {3.9038673029935417`*^9, 3.9038673091434298`*^9}, 
   3.903867367531973*^9, 3.9038680770253572`*^9, {3.904342933160407*^9, 
   3.904342974642146*^9}, {3.9049706546528053`*^9, 3.904970669761735*^9}, {
   3.905410666499625*^9, 3.9054106717979636`*^9}, {3.9054740829009314`*^9, 
   3.9054741584998436`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"2c39fb3f-7167-482b-a25a-df300d880eb9"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of instances where urmin > drmax: \"\>", 
   "\[InvisibleSpace]", "15"}],
  SequenceForm["Number of instances where urmin > drmax: ", 15],
  Editable->False]], "Print",
 CellChangeTimes->{3.906178065071772*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"5ccd9803-ce71-4999-88cc-d29384d73a8e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of instances where drmin > urmax: \"\>", 
   "\[InvisibleSpace]", "10"}],
  SequenceForm["Number of instances where drmin > urmax: ", 10],
  Editable->False]], "Print",
 CellChangeTimes->{3.9061780651106677`*^9},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"839e67af-b227-4e00-89e5-bc4a5bab95ff"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949, 467},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification->1.25,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c45b0872-429a-42e1-968f-5b8a6c6383c6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2611, 48, 586, "Subsection",ExpressionUUID->"7fe09b6c-a211-4c69-884e-8194c3f7cb0c"],
Cell[CellGroupData[{
Cell[3216, 74, 5503, 138, 274, "Input",ExpressionUUID->"8f1533be-93fc-4a00-b7d4-bfe8c3bb8ac8"],
Cell[8722, 214, 235, 3, 40, "Output",ExpressionUUID->"2c6e66ff-8547-4626-9774-2a98e0f3a30a"],
Cell[CellGroupData[{
Cell[8982, 221, 150, 3, 30, "Echo",ExpressionUUID->"53383eab-0456-47b4-be3d-4e5ac6f6b631"],
Cell[9135, 226, 150, 3, 30, "Echo",ExpressionUUID->"3194f732-a095-49e5-8b91-87a2233b8838"],
Cell[9288, 231, 152, 3, 30, "Echo",ExpressionUUID->"49e0d0c8-496b-436d-bae8-c8be717d87af"],
Cell[9443, 236, 158, 3, 30, "Echo",ExpressionUUID->"92b09a43-08df-4366-a151-dce47c4871dc"],
Cell[9604, 241, 155, 3, 30, "Echo",ExpressionUUID->"a071c550-ef6d-4289-acdb-bb5d416484ca"],
Cell[9762, 246, 153, 3, 30, "Echo",ExpressionUUID->"36bfc265-2a30-401a-9980-1a1a144d6064"],
Cell[9918, 251, 154, 3, 30, "Echo",ExpressionUUID->"02b7018d-84e0-4cf9-8986-17fdfc66c0cc"],
Cell[10075, 256, 156, 3, 30, "Echo",ExpressionUUID->"27fe842e-5f0b-41b3-8015-31fe23215618"],
Cell[10234, 261, 156, 3, 30, "Echo",ExpressionUUID->"4526d3d1-dbcb-4090-b6e5-fdff211362b0"]
}, Open  ]],
Cell[10405, 267, 219, 4, 40, "Output",ExpressionUUID->"35073275-887c-49dc-b3fa-262f08b97e43"],
Cell[10627, 273, 300, 4, 65, "Output",ExpressionUUID->"57c1a839-7d00-42d3-a166-51b3c0c90f62"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10976, 283, 305, 7, 62, "Subsection",ExpressionUUID->"3756f8f2-542d-4771-85df-17bc9b26014d"],
Cell[11284, 292, 2554, 38, 555, "Text",ExpressionUUID->"f7410fed-727d-4541-9c59-8c44a531b5ac"],
Cell[13841, 332, 1085, 25, 103, "Input",ExpressionUUID->"50354017-71e3-463e-bfed-fdbe502b1b57"],
Cell[14929, 359, 3105, 96, 297, "Input",ExpressionUUID->"a3cb0087-1fc8-4701-9eea-294d587904c7"],
Cell[CellGroupData[{
Cell[18059, 459, 2329, 57, 250, "Input",ExpressionUUID->"c7ef506b-9ea5-40ec-bd93-32f7a9dfb21e"],
Cell[20391, 518, 23643, 554, 295, "Output",ExpressionUUID->"d7d79d03-1fcb-45ec-8e25-c0bf625cc02f"]
}, Open  ]],
Cell[44049, 1075, 4487, 69, 103, "Input",ExpressionUUID->"6de7a44a-fc10-4e79-94b2-5291b58d8828"],
Cell[CellGroupData[{
Cell[48561, 1148, 578, 10, 52, "Subsubsection",ExpressionUUID->"6bb2c1a3-ef81-46c2-a3a8-ff31ae323afc"],
Cell[CellGroupData[{
Cell[49164, 1162, 1469, 31, 178, "Input",ExpressionUUID->"ebee67b7-4cc4-46aa-b3b8-0dcdfa5bfd49"],
Cell[CellGroupData[{
Cell[50658, 1197, 542, 13, 27, "Print",ExpressionUUID->"1035315b-8dae-43fc-bee6-4b78f30d9acc"],
Cell[51203, 1212, 410, 7, 72, "Print",ExpressionUUID->"c034edc6-6e3c-4c3b-b4ae-8ddd5b7063a9"],
Cell[51616, 1221, 3576, 68, 789, "Print",ExpressionUUID->"af512817-c092-47fe-948a-4c61973b4280"]
}, Open  ]],
Cell[55207, 1292, 441, 9, 40, "Output",ExpressionUUID->"85c5b6e7-3c5f-4443-ab92-86a5c972e9a2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55709, 1308, 601, 12, 62, "Subsection",ExpressionUUID->"8563995e-cdb6-4666-b308-3fae7db4cd29"],
Cell[56313, 1322, 1189, 19, 195, "Text",ExpressionUUID->"d1344fae-e741-4eba-9bb7-f2b769084ccb"],
Cell[CellGroupData[{
Cell[57527, 1345, 365, 8, 60, "Input",ExpressionUUID->"8571a603-b3c4-43a7-bbba-57143cd79415"],
Cell[57895, 1355, 861, 14, 95, "Output",ExpressionUUID->"4e5614c6-244e-4e48-a90c-19eae1276feb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58805, 1375, 388, 8, 62, "Subsection",ExpressionUUID->"0c7d507c-902a-4993-b7ee-a14361e88265"],
Cell[59196, 1385, 1428, 22, 195, "Text",ExpressionUUID->"a33d4ea2-79f7-4d8a-8af9-fce5024a3243"],
Cell[CellGroupData[{
Cell[60649, 1411, 510, 12, 83, "Input",ExpressionUUID->"b3f66ee3-1351-4107-8b1c-6ef557879141"],
Cell[CellGroupData[{
Cell[61184, 1427, 240, 5, 27, "Print",ExpressionUUID->"28a99a96-d6ca-454e-9f98-391430eea07f"],
Cell[61427, 1434, 647, 14, 72, "Print",ExpressionUUID->"79132a56-d695-42f6-9f49-1756272d6eb3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62123, 1454, 178, 2, 35, "Input",ExpressionUUID->"5173f81e-5259-40de-b185-6334f7d0838b"],
Cell[62304, 1458, 15230, 335, 968, "Output",ExpressionUUID->"65b3d68e-10a3-4561-9cfb-66a760a0134b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77583, 1799, 520, 10, 118, "Subsection",ExpressionUUID->"a86f0b7a-3566-4f2d-bc8f-8263370a281a"],
Cell[78106, 1811, 294, 8, 101, "Text",ExpressionUUID->"95668b4b-157e-41ca-911a-a824f815193e"],
Cell[CellGroupData[{
Cell[78425, 1823, 9341, 167, 698, "Input",ExpressionUUID->"2f23cbd4-a653-4e65-8dc5-45774a384026"],
Cell[87769, 1992, 16186, 371, 374, "Output",ExpressionUUID->"99c1ba1a-8191-4d4b-bb6c-27629ef5782c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104004, 2369, 486, 10, 90, "Subsection",ExpressionUUID->"c550463b-0ffd-4ded-b145-a19c883322ff"],
Cell[104493, 2381, 802, 13, 143, "Text",ExpressionUUID->"b6cf214e-c985-4c29-87b3-e713cd1ac9e1"],
Cell[CellGroupData[{
Cell[105320, 2398, 4722, 123, 583, "Input",ExpressionUUID->"dab29fb0-8115-477d-830e-6ba293d817db"],
Cell[CellGroupData[{
Cell[110067, 2525, 9251, 193, 335, "Print",ExpressionUUID->"901a036d-d542-406d-83d3-9ee735e36078"],
Cell[119321, 2720, 13200, 273, 467, "Print",ExpressionUUID->"443f6fa9-8434-425e-a917-7713ecb6a8c6"]
}, Open  ]],
Cell[132536, 2996, 199, 4, 40, "Output",ExpressionUUID->"3f9af178-cf91-41f4-b20c-38357cf0ca4d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[132784, 3006, 426, 9, 62, "Subsection",ExpressionUUID->"28eec9f2-befe-441d-9ac1-8c6313a863ca"],
Cell[133213, 3017, 2364, 35, 401, "Text",ExpressionUUID->"cbb94802-e602-4106-a3ab-292c80f3a395"],
Cell[CellGroupData[{
Cell[135602, 3056, 12647, 317, 1225, "Input",ExpressionUUID->"2c39fb3f-7167-482b-a25a-df300d880eb9"],
Cell[CellGroupData[{
Cell[148274, 3377, 371, 9, 27, "Print",ExpressionUUID->"5ccd9803-ce71-4999-88cc-d29384d73a8e"],
Cell[148648, 3388, 373, 9, 27, "Print",ExpressionUUID->"839e67af-b227-4e00-89e5-bc4a5bab95ff"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

